/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 1);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*const mapBoxUrl = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';*/\nvar mapBoxUrl = 'https://gradska-sreda.dreamradio.org/map/styles/vs/{z}/{x}/{y}.png';\nvar mapBoxAttribution = '&copy <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors';\n\nexports.mapBoxUrl = mapBoxUrl;\nexports.mapBoxAttribution = mapBoxAttribution;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hc3NldHMvZnJvbnQvanMvbWFwLWNvbmZpZy5qcz8xNWU1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qY29uc3QgbWFwQm94VXJsID0gJ2h0dHBzOi8ve3N9LnRpbGUub3BlbnN0cmVldG1hcC5vcmcve3p9L3t4fS97eX0ucG5nJzsqL1xuY29uc3QgbWFwQm94VXJsID0gJ2h0dHBzOi8vZ3JhZHNrYS1zcmVkYS5kcmVhbXJhZGlvLm9yZy9tYXAvc3R5bGVzL3ZzL3t6fS97eH0ve3l9LnBuZyc7XG5jb25zdCBtYXBCb3hBdHRyaWJ1dGlvbiA9IGAmY29weSA8YSBocmVmPVwiaHR0cHM6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvY29weXJpZ2h0XCI+T3BlblN0cmVldE1hcDwvYT4gY29udHJpYnV0b3JzYDtcblxuZXhwb3J0IHttYXBCb3hVcmwsIG1hcEJveEF0dHJpYnV0aW9ufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGFzc2V0cy9mcm9udC9qcy9tYXAtY29uZmlnLmpzIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n");

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n__webpack_require__(2);\n\n__webpack_require__(3);\n\n__webpack_require__(4);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hc3NldHMvZnJvbnQvanMvbWFpbi5qcz82NTJlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAnbWFwLW1haW4nXG5pbXBvcnQgJ21hcC1taW5pJ1xuaW1wb3J0ICdzdXJ2ZXknXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gYXNzZXRzL2Zyb250L2pzL21haW4uanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///1\n");

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _mapConfig = __webpack_require__(0);\n\n(function () {\n    if (!document.getElementById('mapMain')) {\n        return;\n    }\n    var loading = $('.loading');\n    var confirmModal = $('.confirm');\n    $(document).on('click', '[data-confirm-cancel]', function () {\n        removeAllPopups();\n    });\n\n    //const mapCenter = mapOption.center;\n    //const mapZoom = mapOption.zoom;\n\n    var defaultObjectStyle = {\n        color: \"#ff9710\",\n        opacity: 0.5,\n        width: 5\n    };\n    var objectsSettings = {};\n    var initialLoad = false;\n\n    var map = new L.map('mapMain', {\n        updateWhenZooming: false,\n        attributionControl: false\n    });\n\n    var mapStyle = L.tileLayer(_mapConfig.mapBoxUrl, {\n        attribution: _mapConfig.mapBoxAttribution,\n        maxNativeZoom: 19,\n        maxZoom: 21,\n        minZoom: 11,\n        updateWhenZooming: false\n    });\n    mapStyle.addTo(map);\n\n    var myLocationButton = L.Control.extend({\n        options: {\n            position: 'topleft'\n        },\n        onAdd: function onAdd() {\n            var container = L.DomUtil.create('button', 'leaflet-bar leaflet-control-custom far fa-dot-circle');\n            container.type = \"button\";\n            container.onclick = function () {\n                locate();\n            };\n            return container;\n        }\n    });\n    map.addControl(new myLocationButton());\n\n    var myLocationLayerGroup = L.layerGroup();\n    myLocationLayerGroup.addTo(map);\n\n    var popusLayerGroup = L.layerGroup();\n    popusLayerGroup.addTo(map);\n\n    var updateMapThrottle = void 0;\n    map.on('dragend zoomend', function () {\n        clearTimeout(updateMapThrottle);\n        updateMapThrottle = setTimeout(function () {\n            var center = map.getCenter();\n\n            updateMap(center, function () {\n                if (!initialLoad) {\n                    initialLoad = true;\n                    if ($('#mapMain').data('locate-on-load') === true) {\n                        locate();\n                    }\n                }\n            });\n        }, 200);\n    });\n\n    map.on('locationfound', setMapViewToMyLocation);\n    map.on('locationerror', setInitialMapView);\n\n    var geoJsonLayer = L.geoJSON([], {\n        style: function style(feature) {\n            var styles = objectsSettings.styles[feature.properties._s1] ? _extends({}, objectsSettings.styles[feature.properties._s1]) : _extends({}, defaultObjectStyle);\n            return styles;\n        },\n        onEachFeature: function onEachFeature(feature, layer) {\n            layer.on('click', function (ev) {\n                switch (feature.properties._behavior) {\n                    case \"navigation\":\n                        zoomToLayer(layer, ev);\n                        break;\n                    default:\n                        openLayerPopup(layer, ev);\n                        zoomToLayer(layer, ev);\n                        break;\n                }\n            });\n            layer.on('mouseover', function () {\n                if (layer.feature.properties.activePopup) {\n                    return;\n                }\n                if (objectsSettings.styles[feature.properties._s2]) {\n                    setLayerHoverStyle(layer);\n                }\n            });\n            layer.on('mouseout', function () {\n                if (layer.feature.properties.activePopup) {\n                    return;\n                }\n                if (objectsSettings.styles[feature.properties._s1]) {\n                    setLayerDefaultStyle(layer);\n                }\n            });\n        },\n        pointToLayer: function pointToLayer(feature, latlng) {\n            return L.circleMarker(latlng, objectsSettings.styles[feature.properties._s1]);\n        }\n    }).addTo(map);\n\n    setInitialMapView();\n\n    function updateMap(center) {\n        var fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};\n\n        var zoom = map.getZoom();\n        var bounds = map.getBounds();\n        var returnedTarget = {};\n\n        var a = {\n            in: bounds._southWest.lng + ',' + bounds._northEast.lat + ',' + bounds._northEast.lng + ',' + bounds._southWest.lat + ',',\n            zoom: zoom,\n            c: center.lat + ',' + center.lng\n        };\n\n        if (typeof b !== 'undefined') {\n            returnedTarget = Object.assign(a, b);\n        } else {\n            returnedTarget = a;\n        }\n\n        $.ajax({\n            data: returnedTarget,\n            url: \"/front-end/map?\",\n            success: function success(results) {\n                objectsSettings = results.settings;\n                geoJsonLayer.clearLayers();\n                geoJsonLayer.addData(results.objects);\n                fn();\n            }\n        });\n    }\n\n    function saveViewport(center) {\n        var zoom = map.getZoom();\n        var a = {\n            zoom: zoom,\n            c: center.lat + ',' + center.lng\n        };\n\n        $.ajax({\n            data: a,\n            url: \"/map/z\",\n            success: function success(results) {}\n        });\n    }\n\n    function locate() {\n        loading.removeClass('d-none');\n        map.locate({\n            setView: true,\n            maxZoom: objectsSettings.default_zoom\n        });\n    }\n\n    function setMapViewToMyLocation(e) {\n        loading.addClass('d-none');\n        var radius = e.accuracy / 2;\n\n        myLocationLayerGroup.eachLayer(function (layer) {\n            myLocationLayerGroup.removeLayer(layer);\n        });\n\n        var center = L.circle(e.latlng, {\n            color: '#fff',\n            fillColor: '#2A93EE',\n            fillOpacity: 1,\n            weight: 4,\n            opacity: 1,\n            radius: 5\n        }).addTo(myLocationLayerGroup);\n\n        L.circle(e.latlng, {\n            radius: e.accuracy / 2,\n            color: '#136AEC',\n            fillColor: '#136AEC',\n            fillOpacity: 0.15,\n            weight: 0\n        }).addTo(myLocationLayerGroup);\n\n        center.bindPopup(\"Намирате се в радиус от \" + radius + \" метра от тази локация\", {\n            offset: L.point(0, -10)\n        });\n        center.openPopup();\n    }\n\n    function setInitialMapView() {\n        loading.addClass('d-none');\n\n        var zoom = void 0;\n        var lat = void 0;\n        var lng = void 0;\n\n        $.ajax({\n            url: \"/map/p\",\n            success: function success(results) {\n                zoom = results.zoom;\n                lat = results.lat;\n                lng = results.lng;\n                setRealInitialMapView(lat, lng, zoom);\n            }\n        });\n    }\n\n    function setRealInitialMapView(lat, lng, zoom) {\n        map.setView([lat, lng], zoom);\n    }\n\n    function zoomToLayer(layer, ev) {\n        var clickCoordinates = map.mouseEventToLatLng(ev.originalEvent);\n        if (layer.feature.properties._zoom && layer.feature.properties._zoom !== map.getZoom()) {\n            map.setView(clickCoordinates, layer.feature.properties._zoom);\n        } else {\n            map.setView(clickCoordinates);\n\n            saveViewport(clickCoordinates);\n        }\n    }\n\n    function openLayerPopup(layer, ev) {\n        setLayerActiveStyle(layer);\n        removeAllPopups();\n        layer.feature.properties.activePopup = true;\n\n        var coordinates = void 0;\n\n        if (layer.feature.properties._behavior === 'survey') {\n            coordinates = map.mouseEventToLatLng(ev.originalEvent);\n            if (mapOption.survey === true) {\n                openConfirmModal(layer);\n            }\n        } else {\n            coordinates = ev.latlng;\n        }\n\n        var popupLayer = L.circle(coordinates, {\n            fillOpacity: 0,\n            weight: 0,\n            opacity: 0,\n            radius: 1\n        }).addTo(popusLayerGroup);\n\n        var popupContent = '<p class=\"text-center\"><!--<form method=\"post\" class=\"m-form\" action=\"/front-end/geo-collection/add\"><input type=\"hidden\" name=\"geo-object\" value=\"' + layer.feature.properties.id + '\"><button type=\"submit\">' + layer.feature.properties.id + '</button></form>-->' + layer.feature.properties.type + '<br />' + layer.feature.properties.name + '</p>';\n\n        popupLayer.bindPopup(popupContent, {\n            offset: L.point(0, -20)\n        }).on('popupclose', function () {\n            confirmModal.addClass('d-none');\n            layer.feature.properties.activePopup = false;\n            setLayerDefaultStyle(layer);\n            removeAllPopups();\n        }).openPopup();\n\n        var collection = mapOption.collection;\n\n        if (typeof collection !== 'undefined') {\n            $.ajax({\n                type: \"POST\",\n                url: '/front-end/geo-collection/add',\n                data: {\n                    'geo-object': layer.feature.properties.id,\n                    'collection': collection\n                },\n                success: function success() {\n                    updateMap();\n                }\n            });\n        }\n        /*\n                $(\".m-form\").submit(function(e) {\n                    var form = $(this);\n                    var url = form.attr('action');\n                     $.ajax({\n                        type: \"POST\",\n                        url: '/front-end/geo-collection/add',\n                        //data: form.serialize(),\n                        data: {\n                            'geo-object': 'cd538bf5-3220-4259-b26d-3488d71ca7d7'\n                        },\n                        success: function()\n                        {\n                            updateMap();\n                        }\n                    });\n                     e.preventDefault();\n                });\n        */\n    }\n\n    function openConfirmModal(layer) {\n        var dialogTitle = objectsSettings.dialog[layer.feature.properties._dtext] || 'Искате ли да оцените';\n        var dialogLink = '/geo/' + layer.feature.properties.id;\n        confirmModal.removeClass('d-none');\n        confirmModal.find('[data-confirm-title]').html(dialogTitle + '?');\n        confirmModal.find('[data-confirm-link]').attr('href', dialogLink);\n    }\n\n    function removeAllPopups() {\n        map.closePopup();\n        popusLayerGroup.eachLayer(function (layer) {\n            popusLayerGroup.removeLayer(layer);\n        });\n    }\n\n    function setLayerDefaultStyle(layer) {\n        layer.setStyle(objectsSettings.styles[layer.feature.properties._s1] || defaultObjectStyle);\n    }\n\n    function setLayerHoverStyle(layer) {\n        layer.setStyle(objectsSettings.styles[layer.feature.properties._s2]);\n    }\n\n    function setLayerActiveStyle(layer) {\n        switch (layer.feature.geometry.type) {\n            case \"Point\":\n                layer.setStyle(objectsSettings.styles['on_dialog_point']);\n                break;\n            case \"MultiLineString\":\n                layer.setStyle(objectsSettings.styles['on_dialog_line']);\n                break;\n            case \"Polygon\":\n                layer.setStyle(objectsSettings.styles['on_dialog_polygon']);\n                break;\n        }\n    }\n})();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hc3NldHMvZnJvbnQvanMvbWFwLW1haW4uanM/NzkzNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge21hcEJveEF0dHJpYnV0aW9uLCBtYXBCb3hVcmx9IGZyb20gJy4vbWFwLWNvbmZpZyc7XG5cbigoKSA9PiB7XG4gICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwTWFpbicpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbG9hZGluZyA9ICQoJy5sb2FkaW5nJyk7XG4gICAgY29uc3QgY29uZmlybU1vZGFsID0gJCgnLmNvbmZpcm0nKTtcbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnW2RhdGEtY29uZmlybS1jYW5jZWxdJywgZnVuY3Rpb24gKCkge1xuICAgICAgICByZW1vdmVBbGxQb3B1cHMoKTtcbiAgICB9KTtcblxuICAgIC8vY29uc3QgbWFwQ2VudGVyID0gbWFwT3B0aW9uLmNlbnRlcjtcbiAgICAvL2NvbnN0IG1hcFpvb20gPSBtYXBPcHRpb24uem9vbTtcblxuICAgIGNvbnN0IGRlZmF1bHRPYmplY3RTdHlsZSA9IHtcbiAgICAgICAgY29sb3I6IFwiI2ZmOTcxMFwiLFxuICAgICAgICBvcGFjaXR5OiAwLjUsXG4gICAgICAgIHdpZHRoOiA1XG4gICAgfTtcbiAgICBsZXQgb2JqZWN0c1NldHRpbmdzID0ge307XG4gICAgbGV0IGluaXRpYWxMb2FkID0gZmFsc2U7XG5cbiAgICBsZXQgbWFwID0gbmV3IEwubWFwKCdtYXBNYWluJywge1xuICAgICAgICB1cGRhdGVXaGVuWm9vbWluZzogZmFsc2UsXG4gICAgICAgIGF0dHJpYnV0aW9uQ29udHJvbDogZmFsc2VcbiAgICB9KTtcblxuICAgIGxldCBtYXBTdHlsZSA9IEwudGlsZUxheWVyKG1hcEJveFVybCwge1xuICAgICAgICBhdHRyaWJ1dGlvbjogbWFwQm94QXR0cmlidXRpb24sXG4gICAgICAgIG1heE5hdGl2ZVpvb206IDE5LFxuICAgICAgICBtYXhab29tOiAyMSxcbiAgICAgICAgbWluWm9vbTogMTEsXG4gICAgICAgIHVwZGF0ZVdoZW5ab29taW5nOiBmYWxzZVxuICAgIH0pO1xuICAgIG1hcFN0eWxlLmFkZFRvKG1hcCk7XG5cbiAgICBsZXQgbXlMb2NhdGlvbkJ1dHRvbiA9IEwuQ29udHJvbC5leHRlbmQoe1xuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICBwb3NpdGlvbjogJ3RvcGxlZnQnXG4gICAgICAgIH0sXG4gICAgICAgIG9uQWRkOiAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgY29udGFpbmVyID0gTC5Eb21VdGlsLmNyZWF0ZSgnYnV0dG9uJywgJ2xlYWZsZXQtYmFyIGxlYWZsZXQtY29udHJvbC1jdXN0b20gZmFyIGZhLWRvdC1jaXJjbGUnKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci50eXBlID0gXCJidXR0b25cIjtcbiAgICAgICAgICAgIGNvbnRhaW5lci5vbmNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxvY2F0ZSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBjb250YWluZXI7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBtYXAuYWRkQ29udHJvbChuZXcgbXlMb2NhdGlvbkJ1dHRvbigpKTtcblxuICAgIGxldCBteUxvY2F0aW9uTGF5ZXJHcm91cCA9IEwubGF5ZXJHcm91cCgpO1xuICAgIG15TG9jYXRpb25MYXllckdyb3VwLmFkZFRvKG1hcCk7XG5cbiAgICBsZXQgcG9wdXNMYXllckdyb3VwID0gTC5sYXllckdyb3VwKCk7XG4gICAgcG9wdXNMYXllckdyb3VwLmFkZFRvKG1hcCk7XG5cbiAgICBsZXQgdXBkYXRlTWFwVGhyb3R0bGU7XG4gICAgbWFwLm9uKCdkcmFnZW5kIHpvb21lbmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh1cGRhdGVNYXBUaHJvdHRsZSk7XG4gICAgICAgIHVwZGF0ZU1hcFRocm90dGxlID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBsZXQgY2VudGVyID0gbWFwLmdldENlbnRlcigpO1xuXG4gICAgICAgICAgICB1cGRhdGVNYXAoY2VudGVyLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFpbml0aWFsTG9hZCkge1xuICAgICAgICAgICAgICAgICAgICBpbml0aWFsTG9hZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkKCcjbWFwTWFpbicpLmRhdGEoJ2xvY2F0ZS1vbi1sb2FkJykgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSwgMjAwKTtcbiAgICB9KTtcblxuICAgIG1hcC5vbignbG9jYXRpb25mb3VuZCcsIHNldE1hcFZpZXdUb015TG9jYXRpb24pO1xuICAgIG1hcC5vbignbG9jYXRpb25lcnJvcicsIHNldEluaXRpYWxNYXBWaWV3KTtcblxuICAgIGxldCBnZW9Kc29uTGF5ZXIgPSBMLmdlb0pTT04oW10sIHsgXG4gICAgICAgIHN0eWxlOiBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgICAgICAgbGV0IHN0eWxlcyA9IG9iamVjdHNTZXR0aW5ncy5zdHlsZXNbZmVhdHVyZS5wcm9wZXJ0aWVzLl9zMV0gPyB7Li4ub2JqZWN0c1NldHRpbmdzLnN0eWxlc1tmZWF0dXJlLnByb3BlcnRpZXMuX3MxXX0gOiB7Li4uZGVmYXVsdE9iamVjdFN0eWxlfTtcbiAgICAgICAgICAgIHJldHVybiBzdHlsZXM7XG4gICAgICAgIH0sXG4gICAgICAgIG9uRWFjaEZlYXR1cmU6IGZ1bmN0aW9uIChmZWF0dXJlLCBsYXllcikge1xuICAgICAgICAgICAgbGF5ZXIub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChmZWF0dXJlLnByb3BlcnRpZXMuX2JlaGF2aW9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJuYXZpZ2F0aW9uXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICB6b29tVG9MYXllcihsYXllciwgZXYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVuTGF5ZXJQb3B1cChsYXllciwgZXYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgem9vbVRvTGF5ZXIobGF5ZXIsIGV2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbGF5ZXIub24oJ21vdXNlb3ZlcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAobGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLmFjdGl2ZVBvcHVwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG9iamVjdHNTZXR0aW5ncy5zdHlsZXNbZmVhdHVyZS5wcm9wZXJ0aWVzLl9zMl0pIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0TGF5ZXJIb3ZlclN0eWxlKGxheWVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGxheWVyLm9uKCdtb3VzZW91dCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAobGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLmFjdGl2ZVBvcHVwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG9iamVjdHNTZXR0aW5ncy5zdHlsZXNbZmVhdHVyZS5wcm9wZXJ0aWVzLl9zMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0TGF5ZXJEZWZhdWx0U3R5bGUobGF5ZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBwb2ludFRvTGF5ZXI6IGZ1bmN0aW9uIChmZWF0dXJlLCBsYXRsbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBMLmNpcmNsZU1hcmtlcihsYXRsbmcsIG9iamVjdHNTZXR0aW5ncy5zdHlsZXNbZmVhdHVyZS5wcm9wZXJ0aWVzLl9zMV0pO1xuICAgICAgICB9XG4gICAgfSkuYWRkVG8obWFwKTtcblxuICAgIHNldEluaXRpYWxNYXBWaWV3KCk7XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVNYXAoY2VudGVyLCBmbiA9ICgpID0+IHtcbiAgICB9KSB7XG4gICAgICAgIGxldCB6b29tID0gbWFwLmdldFpvb20oKTtcbiAgICAgICAgbGV0IGJvdW5kcyA9IG1hcC5nZXRCb3VuZHMoKTtcbiAgICAgICAgbGV0IHJldHVybmVkVGFyZ2V0ID0ge307XG5cbiAgICAgICAgbGV0IGEgPSB7XG4gICAgICAgICAgICBpbjogYm91bmRzLl9zb3V0aFdlc3QubG5nICsgJywnICtcbiAgICAgICAgICAgIGJvdW5kcy5fbm9ydGhFYXN0LmxhdCArICcsJyArXG4gICAgICAgICAgICBib3VuZHMuX25vcnRoRWFzdC5sbmcgKyAnLCcgK1xuICAgICAgICAgICAgYm91bmRzLl9zb3V0aFdlc3QubGF0ICsgJywnLFxuICAgICAgICAgICAgem9vbTogem9vbSxcbiAgICAgICAgICAgIGM6IGNlbnRlci5sYXQgKyAnLCcgKyBjZW50ZXIubG5nXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgcmV0dXJuZWRUYXJnZXQgPSBPYmplY3QuYXNzaWduKGEsIGIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuZWRUYXJnZXQgPSBhO1xuICAgICAgICB9XG5cbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIGRhdGE6IHJldHVybmVkVGFyZ2V0LFxuICAgICAgICAgICAgdXJsOiBcIi9mcm9udC1lbmQvbWFwP1wiLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgICAgICAgICBvYmplY3RzU2V0dGluZ3MgPSByZXN1bHRzLnNldHRpbmdzO1xuICAgICAgICAgICAgICAgIGdlb0pzb25MYXllci5jbGVhckxheWVycygpO1xuICAgICAgICAgICAgICAgIGdlb0pzb25MYXllci5hZGREYXRhKHJlc3VsdHMub2JqZWN0cyk7XG4gICAgICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2F2ZVZpZXdwb3J0KGNlbnRlcikge1xuICAgICAgICBsZXQgem9vbSA9IG1hcC5nZXRab29tKCk7XG4gICAgICAgIGxldCBhID0ge1xuICAgICAgICAgICAgem9vbTogem9vbSxcbiAgICAgICAgICAgIGM6IGNlbnRlci5sYXQgKyAnLCcgKyBjZW50ZXIubG5nXG4gICAgICAgIH07XG5cbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIGRhdGE6IGEsXG4gICAgICAgICAgICB1cmw6IFwiL21hcC96XCIsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0cykge1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvY2F0ZSgpIHtcbiAgICAgICAgbG9hZGluZy5yZW1vdmVDbGFzcygnZC1ub25lJyk7XG4gICAgICAgIG1hcC5sb2NhdGUoe1xuICAgICAgICAgICAgc2V0VmlldzogdHJ1ZSxcbiAgICAgICAgICAgIG1heFpvb206IG9iamVjdHNTZXR0aW5ncy5kZWZhdWx0X3pvb21cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0TWFwVmlld1RvTXlMb2NhdGlvbihlKSB7XG4gICAgICAgIGxvYWRpbmcuYWRkQ2xhc3MoJ2Qtbm9uZScpO1xuICAgICAgICBsZXQgcmFkaXVzID0gZS5hY2N1cmFjeSAvIDI7XG5cbiAgICAgICAgbXlMb2NhdGlvbkxheWVyR3JvdXAuZWFjaExheWVyKChsYXllcikgPT4ge1xuICAgICAgICAgICAgbXlMb2NhdGlvbkxheWVyR3JvdXAucmVtb3ZlTGF5ZXIobGF5ZXIpO1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgY2VudGVyID0gTC5jaXJjbGUoZS5sYXRsbmcsIHtcbiAgICAgICAgICAgIGNvbG9yOiAnI2ZmZicsXG4gICAgICAgICAgICBmaWxsQ29sb3I6ICcjMkE5M0VFJyxcbiAgICAgICAgICAgIGZpbGxPcGFjaXR5OiAxLFxuICAgICAgICAgICAgd2VpZ2h0OiA0LFxuICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgIHJhZGl1czogNVxuICAgICAgICB9KS5hZGRUbyhteUxvY2F0aW9uTGF5ZXJHcm91cCk7XG5cbiAgICAgICAgTC5jaXJjbGUoZS5sYXRsbmcsIHtcbiAgICAgICAgICAgIHJhZGl1czogZS5hY2N1cmFjeSAvIDIsXG4gICAgICAgICAgICBjb2xvcjogJyMxMzZBRUMnLFxuICAgICAgICAgICAgZmlsbENvbG9yOiAnIzEzNkFFQycsXG4gICAgICAgICAgICBmaWxsT3BhY2l0eTogMC4xNSxcbiAgICAgICAgICAgIHdlaWdodDogMFxuICAgICAgICB9KS5hZGRUbyhteUxvY2F0aW9uTGF5ZXJHcm91cCk7XG5cbiAgICAgICAgY2VudGVyLmJpbmRQb3B1cChcItCd0LDQvNC40YDQsNGC0LUg0YHQtSDQsiDRgNCw0LTQuNGD0YEg0L7RgiBcIiArIHJhZGl1cyArIFwiINC80LXRgtGA0LAg0L7RgiDRgtCw0LfQuCDQu9C+0LrQsNGG0LjRj1wiLCB7XG4gICAgICAgICAgICBvZmZzZXQ6IEwucG9pbnQoMCwgLTEwKVxuICAgICAgICB9KTtcbiAgICAgICAgY2VudGVyLm9wZW5Qb3B1cCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldEluaXRpYWxNYXBWaWV3KCkge1xuICAgICAgICBsb2FkaW5nLmFkZENsYXNzKCdkLW5vbmUnKTtcblxuICAgICAgICBsZXQgem9vbTtcbiAgICAgICAgbGV0IGxhdDtcbiAgICAgICAgbGV0IGxuZztcblxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiBcIi9tYXAvcFwiLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgICAgICAgICB6b29tID0gcmVzdWx0cy56b29tO1xuICAgICAgICAgICAgICAgIGxhdCA9IHJlc3VsdHMubGF0O1xuICAgICAgICAgICAgICAgIGxuZyA9IHJlc3VsdHMubG5nO1xuICAgICAgICAgICAgICAgIHNldFJlYWxJbml0aWFsTWFwVmlldyhsYXQsIGxuZywgem9vbSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0UmVhbEluaXRpYWxNYXBWaWV3KGxhdCwgbG5nLCB6b29tKSB7XG4gICAgICAgIG1hcC5zZXRWaWV3KFtsYXQsIGxuZ10sIHpvb20pXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gem9vbVRvTGF5ZXIobGF5ZXIsIGV2KSB7XG4gICAgICAgIGxldCBjbGlja0Nvb3JkaW5hdGVzID0gbWFwLm1vdXNlRXZlbnRUb0xhdExuZyhldi5vcmlnaW5hbEV2ZW50KTtcbiAgICAgICAgaWYgKGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5fem9vbSAmJiBsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuX3pvb20gIT09IG1hcC5nZXRab29tKCkpIHtcbiAgICAgICAgICAgIG1hcC5zZXRWaWV3KGNsaWNrQ29vcmRpbmF0ZXMsIGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5fem9vbSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtYXAuc2V0VmlldyhjbGlja0Nvb3JkaW5hdGVzKTtcblxuICAgICAgICAgICAgc2F2ZVZpZXdwb3J0KGNsaWNrQ29vcmRpbmF0ZXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb3BlbkxheWVyUG9wdXAobGF5ZXIsIGV2KSB7XG4gICAgICAgIHNldExheWVyQWN0aXZlU3R5bGUobGF5ZXIpO1xuICAgICAgICByZW1vdmVBbGxQb3B1cHMoKTtcbiAgICAgICAgbGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLmFjdGl2ZVBvcHVwID0gdHJ1ZTtcblxuICAgICAgICBsZXQgY29vcmRpbmF0ZXM7XG5cblxuICAgICAgICBpZiAobGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLl9iZWhhdmlvciA9PT0gJ3N1cnZleScpIHtcbiAgICAgICAgICAgIGNvb3JkaW5hdGVzID0gbWFwLm1vdXNlRXZlbnRUb0xhdExuZyhldi5vcmlnaW5hbEV2ZW50KTtcbiAgICAgICAgICAgIGlmIChtYXBPcHRpb24uc3VydmV5ID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgb3BlbkNvbmZpcm1Nb2RhbChsYXllcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb29yZGluYXRlcyA9IGV2LmxhdGxuZztcbiAgICAgICAgfVxuXG5cbiAgICAgICAgbGV0IHBvcHVwTGF5ZXIgPSBMLmNpcmNsZShjb29yZGluYXRlcywge1xuICAgICAgICAgICAgZmlsbE9wYWNpdHk6IDAsXG4gICAgICAgICAgICB3ZWlnaHQ6IDAsXG4gICAgICAgICAgICBvcGFjaXR5OiAwLFxuICAgICAgICAgICAgcmFkaXVzOiAxXG4gICAgICAgIH0pLmFkZFRvKHBvcHVzTGF5ZXJHcm91cCk7XG5cbiAgICAgICAgbGV0IHBvcHVwQ29udGVudCA9IGA8cCBjbGFzcz1cInRleHQtY2VudGVyXCI+PCEtLTxmb3JtIG1ldGhvZD1cInBvc3RcIiBjbGFzcz1cIm0tZm9ybVwiIGFjdGlvbj1cIi9mcm9udC1lbmQvZ2VvLWNvbGxlY3Rpb24vYWRkXCI+PGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwiZ2VvLW9iamVjdFwiIHZhbHVlPVwiJHtsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuaWR9XCI+PGJ1dHRvbiB0eXBlPVwic3VibWl0XCI+JHtsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuaWR9PC9idXR0b24+PC9mb3JtPi0tPiR7bGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLnR5cGV9PGJyIC8+JHtsYXllci5mZWF0dXJlLnByb3BlcnRpZXMubmFtZX08L3A+YDtcblxuICAgICAgICBwb3B1cExheWVyLmJpbmRQb3B1cChwb3B1cENvbnRlbnQsIHtcbiAgICAgICAgICAgIG9mZnNldDogTC5wb2ludCgwLCAtMjApXG4gICAgICAgIH0pLm9uKCdwb3B1cGNsb3NlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uZmlybU1vZGFsLmFkZENsYXNzKCdkLW5vbmUnKTtcbiAgICAgICAgICAgIGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5hY3RpdmVQb3B1cCA9IGZhbHNlO1xuICAgICAgICAgICAgc2V0TGF5ZXJEZWZhdWx0U3R5bGUobGF5ZXIpO1xuICAgICAgICAgICAgcmVtb3ZlQWxsUG9wdXBzKCk7XG4gICAgICAgIH0pLm9wZW5Qb3B1cCgpO1xuXG4gICAgICAgIGxldCBjb2xsZWN0aW9uID0gbWFwT3B0aW9uLmNvbGxlY3Rpb247XG5cbiAgICAgICAgaWYgKHR5cGVvZiBjb2xsZWN0aW9uICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcbiAgICAgICAgICAgICAgICB1cmw6ICcvZnJvbnQtZW5kL2dlby1jb2xsZWN0aW9uL2FkZCcsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAnZ2VvLW9iamVjdCc6IGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5pZCxcbiAgICAgICAgICAgICAgICAgICAgJ2NvbGxlY3Rpb24nOiBjb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZU1hcCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8qXG4gICAgICAgICAgICAgICAgJChcIi5tLWZvcm1cIikuc3VibWl0KGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvcm0gPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gZm9ybS5hdHRyKCdhY3Rpb24nKTtcblxuICAgICAgICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvZnJvbnQtZW5kL2dlby1jb2xsZWN0aW9uL2FkZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2RhdGE6IGZvcm0uc2VyaWFsaXplKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2dlby1vYmplY3QnOiAnY2Q1MzhiZjUtMzIyMC00MjU5LWIyNmQtMzQ4OGQ3MWNhN2Q3J1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVNYXAoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAqL1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9wZW5Db25maXJtTW9kYWwobGF5ZXIpIHtcbiAgICAgICAgbGV0IGRpYWxvZ1RpdGxlID0gb2JqZWN0c1NldHRpbmdzLmRpYWxvZ1tsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuX2R0ZXh0XSB8fCAn0JjRgdC60LDRgtC1INC70Lgg0LTQsCDQvtGG0LXQvdC40YLQtSc7XG4gICAgICAgIGxldCBkaWFsb2dMaW5rID0gJy9nZW8vJyArIGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5pZDtcbiAgICAgICAgY29uZmlybU1vZGFsLnJlbW92ZUNsYXNzKCdkLW5vbmUnKTtcbiAgICAgICAgY29uZmlybU1vZGFsLmZpbmQoJ1tkYXRhLWNvbmZpcm0tdGl0bGVdJykuaHRtbChgJHtkaWFsb2dUaXRsZX0/YCk7XG4gICAgICAgIGNvbmZpcm1Nb2RhbC5maW5kKCdbZGF0YS1jb25maXJtLWxpbmtdJykuYXR0cignaHJlZicsIGRpYWxvZ0xpbmspO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbW92ZUFsbFBvcHVwcygpIHtcbiAgICAgICAgbWFwLmNsb3NlUG9wdXAoKTtcbiAgICAgICAgcG9wdXNMYXllckdyb3VwLmVhY2hMYXllcigobGF5ZXIpID0+IHtcbiAgICAgICAgICAgIHBvcHVzTGF5ZXJHcm91cC5yZW1vdmVMYXllcihsYXllcik7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldExheWVyRGVmYXVsdFN0eWxlKGxheWVyKSB7XG4gICAgICAgIGxheWVyLnNldFN0eWxlKG9iamVjdHNTZXR0aW5ncy5zdHlsZXNbbGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLl9zMV0gfHwgZGVmYXVsdE9iamVjdFN0eWxlKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldExheWVySG92ZXJTdHlsZShsYXllcikge1xuICAgICAgICBsYXllci5zZXRTdHlsZShvYmplY3RzU2V0dGluZ3Muc3R5bGVzW2xheWVyLmZlYXR1cmUucHJvcGVydGllcy5fczJdKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldExheWVyQWN0aXZlU3R5bGUobGF5ZXIpIHtcbiAgICAgICAgc3dpdGNoIChsYXllci5mZWF0dXJlLmdlb21ldHJ5LnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJQb2ludFwiOlxuICAgICAgICAgICAgICAgIGxheWVyLnNldFN0eWxlKG9iamVjdHNTZXR0aW5ncy5zdHlsZXNbJ29uX2RpYWxvZ19wb2ludCddKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJNdWx0aUxpbmVTdHJpbmdcIjpcbiAgICAgICAgICAgICAgICBsYXllci5zZXRTdHlsZShvYmplY3RzU2V0dGluZ3Muc3R5bGVzWydvbl9kaWFsb2dfbGluZSddKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJQb2x5Z29uXCI6XG4gICAgICAgICAgICAgICAgbGF5ZXIuc2V0U3R5bGUob2JqZWN0c1NldHRpbmdzLnN0eWxlc1snb25fZGlhbG9nX3BvbHlnb24nXSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGFzc2V0cy9mcm9udC9qcy9tYXAtbWFpbi5qcyJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWEE7QUFhQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBcENBO0FBQ0E7QUFzQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFOQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFDQTtBQU9BO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFUQTtBQVdBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFXQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///2\n");

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _mapConfig = __webpack_require__(0);\n\n(function () {\n\n    if (!document.getElementById('mapMini')) {\n        return;\n    }\n    var loading = $('.loading');\n    var confirmModal = $('.confirm');\n    $(document).on('click', '[data-confirm-cancel]', function () {\n        removeAllPopups();\n    });\n\n    //const mapCenter = mapOption.center;\n    //const mapZoom = mapOption.zoom;\n\n    var defaultObjectStyle = {\n        color: \"#ff9710\",\n        opacity: 0.5,\n        width: 5\n    };\n    var objectsSettings = {};\n    var initialLoad = false;\n\n    var map = new L.map('mapMini', {\n        updateWhenZooming: false,\n        attributionControl: false\n    });\n\n    var mapStyle = L.tileLayer(_mapConfig.mapBoxUrl, {\n        attribution: _mapConfig.mapBoxAttribution,\n        maxNativeZoom: 19,\n        maxZoom: 21,\n        minZoom: 11,\n        updateWhenZooming: false\n    });\n    mapStyle.addTo(map);\n\n    var myLocationButton = L.Control.extend({\n        options: {\n            position: 'topleft'\n        },\n        onAdd: function onAdd() {\n            var container = L.DomUtil.create('button', 'leaflet-bar leaflet-control-custom far fa-dot-circle');\n            container.type = \"button\";\n            container.onclick = function () {\n                locate();\n            };\n            return container;\n        }\n    });\n    map.addControl(new myLocationButton());\n\n    var myLocationLayerGroup = L.layerGroup();\n    myLocationLayerGroup.addTo(map);\n\n    var popusLayerGroup = L.layerGroup();\n    popusLayerGroup.addTo(map);\n\n    var updateMapThrottle = void 0;\n    map.on('dragend zoomend', function () {\n        clearTimeout(updateMapThrottle);\n        updateMapThrottle = setTimeout(function () {\n            var center = map.getCenter();\n\n            updateMap(center, function () {\n                if (!initialLoad) {\n                    initialLoad = true;\n                    if ($('#mapMini').data('locate-on-load') === true) {\n                        locate();\n                    }\n                }\n            });\n        }, 200);\n    });\n\n    map.on('locationfound', setMapViewToMyLocation);\n    map.on('locationerror', setInitialMapView);\n\n    var geoJsonLayer = L.geoJSON([], {\n        style: function style(feature) {\n            return objectsSettings.styles[feature.properties._s1] ? _extends({}, objectsSettings.styles[feature.properties._s1]) : _extends({}, defaultObjectStyle);\n        },\n        onEachFeature: function onEachFeature(feature, layer) {\n            layer.on('click', function (ev) {\n                switch (feature.properties._behavior) {\n                    case \"navigation\":\n                        zoomToLayer(layer, ev);\n                        break;\n                    default:\n                        openLayerPopup(layer, ev);\n                        zoomToLayer(layer, ev);\n                        break;\n                }\n            });\n            layer.on('mouseover', function () {\n                if (layer.feature.properties.activePopup) {\n                    return;\n                }\n                if (objectsSettings.styles[feature.properties._s2]) {\n                    setLayerHoverStyle(layer);\n                }\n            });\n            layer.on('mouseout', function () {\n                if (layer.feature.properties.activePopup) {\n                    return;\n                }\n                if (objectsSettings.styles[feature.properties._s1]) {\n                    setLayerDefaultStyle(layer);\n                }\n            });\n        },\n        pointToLayer: function pointToLayer(feature, latlng) {\n            return L.circleMarker(latlng, objectsSettings.styles[feature.properties._s1]);\n        }\n    }).addTo(map);\n\n    setInitialMapView();\n    geoCollection();\n\n    function updateMap(center) {\n        var fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};\n\n        var zoom = map.getZoom();\n        var bounds = map.getBounds();\n        var returnedTarget = {};\n\n        var a = {\n            in: bounds._southWest.lng + ',' + bounds._northEast.lat + ',' + bounds._northEast.lng + ',' + bounds._southWest.lat + ',',\n            zoom: zoom,\n            c: center.lat + ',' + center.lng,\n            g: mapOption.collection\n        };\n\n        if (typeof b !== 'undefined') {\n            returnedTarget = Object.assign(a, b);\n        } else {\n            returnedTarget = a;\n        }\n\n        $.ajax({\n            data: returnedTarget,\n            url: \"/front-end/map?\",\n            success: function success(results) {\n                objectsSettings = results.settings;\n                geoJsonLayer.clearLayers();\n                geoJsonLayer.addData(results.objects);\n                /*\n                                map.fitBounds(results.bbox, {\n                                 });\n                */\n                fn();\n            }\n        });\n    }\n\n    function saveViewport(center) {\n        var zoom = map.getZoom();\n        var a = {\n            zoom: zoom,\n            c: center.lat + ',' + center.lng\n        };\n\n        $.ajax({\n            data: a,\n            url: \"/map/z\",\n            success: function success() {}\n        });\n    }\n\n    function locate() {\n        loading.removeClass('d-none');\n        map.locate({\n            setView: true,\n            maxZoom: objectsSettings.default_zoom\n        });\n    }\n\n    function setMapViewToMyLocation(e) {\n        loading.addClass('d-none');\n        var radius = e.accuracy / 2;\n\n        myLocationLayerGroup.eachLayer(function (layer) {\n            myLocationLayerGroup.removeLayer(layer);\n        });\n\n        var center = L.circle(e.latlng, {\n            color: '#fff',\n            fillColor: '#2A93EE',\n            fillOpacity: 1,\n            weight: 4,\n            opacity: 1,\n            radius: 5\n        }).addTo(myLocationLayerGroup);\n\n        L.circle(e.latlng, {\n            radius: e.accuracy / 2,\n            color: '#136AEC',\n            fillColor: '#136AEC',\n            fillOpacity: 0.15,\n            weight: 0\n        }).addTo(myLocationLayerGroup);\n\n        center.bindPopup(\"Намирате се в радиус от \" + radius + \" метра от тази локация\", {\n            offset: L.point(0, -10)\n        });\n        center.openPopup();\n    }\n\n    function setInitialMapView() {\n        loading.addClass('d-none');\n\n        var zoom = void 0;\n        var lat = void 0;\n        var lng = void 0;\n\n        if (_typeof(mapOption.bbox) == \"object\") {\n            map.fitBounds(mapOption.bbox, {});\n        } else {\n            $.ajax({\n                url: \"/map/p\",\n                success: function success(results) {\n                    zoom = results.zoom;\n                    lat = results.lat;\n                    lng = results.lng;\n\n                    setRealInitialMapView(lat, lng, zoom);\n                }\n            });\n        }\n    }\n\n    function setRealInitialMapView(lat, lng, zoom) {\n        map.setView([lat, lng], zoom);\n    }\n\n    function zoomToLayer(layer, ev) {\n        var clickCoordinates = map.mouseEventToLatLng(ev.originalEvent);\n        if (layer.feature.properties._zoom && layer.feature.properties._zoom !== map.getZoom()) {\n            map.setView(clickCoordinates, layer.feature.properties._zoom);\n        } else {\n            map.setView(clickCoordinates);\n\n            saveViewport(clickCoordinates);\n        }\n    }\n\n    function openLayerPopup(layer, ev) {\n        setLayerActiveStyle(layer);\n        removeAllPopups();\n        layer.feature.properties.activePopup = true;\n\n        var coordinates = void 0;\n\n        if (layer.feature.properties._behavior === 'survey') {\n            coordinates = map.mouseEventToLatLng(ev.originalEvent);\n            if (mapOption.survey === true) {\n                openConfirmModal(layer);\n            }\n        } else {\n            coordinates = ev.latlng;\n        }\n\n        var popupLayer = L.circle(coordinates, {\n            fillOpacity: 0,\n            weight: 0,\n            opacity: 0,\n            radius: 1\n        }).addTo(popusLayerGroup);\n\n        var popupContent = '<p class=\"text-center\"><!--<form method=\"post\" class=\"m-form\" action=\"/front-end/geo-collection/add\"><input type=\"hidden\" name=\"geo-object\" value=\"' + layer.feature.properties.id + '\"><button type=\"submit\">' + layer.feature.properties.id + '</button></form>-->' + layer.feature.properties.type + '<br />' + layer.feature.properties.name + '</p>';\n\n        popupLayer.bindPopup(popupContent, {\n            offset: L.point(0, -20)\n        }).on('popupclose', function () {\n            confirmModal.addClass('d-none');\n            layer.feature.properties.activePopup = false;\n            setLayerDefaultStyle(layer);\n            removeAllPopups();\n        }).openPopup();\n\n        var collection = mapOption.collection;\n\n        if (typeof collection !== 'undefined') {\n            $.ajax({\n                type: \"POST\",\n                url: '/front-end/geo-collection/add',\n                data: {\n                    'geo-object': layer.feature.properties.id,\n                    'collection': collection\n                },\n                success: function success() {\n                    var center = map.getCenter();\n                    updateMap(center);\n                }\n            });\n\n            geoCollection();\n        }\n\n        /*\n                $(\".m-form\").submit(function(e) {\n                    var form = $(this);\n                    var url = form.attr('action');\n                     $.ajax({\n                        type: \"POST\",\n                        url: '/front-end/geo-collection/add',\n                        //data: form.serialize(),\n                        data: {\n                            'geo-object': 'cd538bf5-3220-4259-b26d-3488d71ca7d7'\n                        },\n                        success: function()\n                        {\n                            updateMap();\n                        }\n                    });\n                     e.preventDefault();\n                });\n        */\n    }\n\n    function geoCollection() {\n        $.ajax({\n            url: \"/geo-collection/info\",\n            success: function success(result) {\n                var html = '<ul class=\"mt-4 pl-4\">';\n\n                Object.keys(result).forEach(function (item) {\n                    html += '<li class=\"mb-2\">\\n\\t\\t\\t\\t\\t\\t\\t<a href=\"/geo-collection/' + result[item].collection_uuid + '\" class=\"font-weight-bold\">\\u041C\\u0430\\u0440\\u0448\\u0440\\u0443\\u0442</a>';\n                    if (typeof gcOpen !== 'undefined') {\n                        if (gcOpen === result[item].collection_uuid) {\n                            html += ' [<span class=\"text-success\">\\u0430\\u043A\\u0442\\u0438\\u0432\\u0435\\u043D</span>]\\n\\t\\t\\t\\t\\t\\t\\t<form method=\"post\" class=\"float-right\">\\n\\t\\t\\t\\t\\t\\t\\t    <input type=\"hidden\" name=\"_method\" value=\"delete\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<button type=\"submit\" class=\"btn btn-sm btn-danger\" style=\"font-size: 11px; padding: 4px 5px 0\"><i class=\"fa fa-trash\"></i> </button>\\n\\t\\t\\t\\t\\t\\t\\t</form>';\n                        }\n                    }\n\n                    html += '<div>\\n\\t\\t\\t\\t\\t\\t\\t\\u0434\\u044A\\u043B\\u0436\\u0438\\u043D\\u0430: ' + result[item].length + ' \\u043C<br />\\n\\t\\t\\t\\t\\t\\t\\t\\u043E\\u0446\\u0435\\u043D\\u0435\\u043D: ' + result[item].completion.percentage + ' %<br />\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\"progress\" style=\"height: 3px;\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\"progress-bar\" role=\"progressbar\" style=\"width: ' + result[item].completion.percentage + '%;\" aria-valuenow=\"25\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t</li>';\n                });\n\n                html += '</ul>';\n\n                $(\"#div3\").html(html);\n            }\n        });\n    }\n\n    function openConfirmModal(layer) {\n        var dialogTitle = objectsSettings.dialog[layer.feature.properties._dtext] || 'Искате ли да оцените';\n        var dialogLink = '/geo/' + layer.feature.properties.id;\n        confirmModal.removeClass('d-none');\n        confirmModal.find('[data-confirm-title]').html(dialogTitle + '?');\n        confirmModal.find('[data-confirm-link]').attr('href', dialogLink);\n    }\n\n    function removeAllPopups() {\n        map.closePopup();\n        popusLayerGroup.eachLayer(function (layer) {\n            popusLayerGroup.removeLayer(layer);\n        });\n    }\n\n    function setLayerDefaultStyle(layer) {\n        layer.setStyle(objectsSettings.styles[layer.feature.properties._s1] || defaultObjectStyle);\n    }\n\n    function setLayerHoverStyle(layer) {\n        layer.setStyle(objectsSettings.styles[layer.feature.properties._s2]);\n    }\n\n    function setLayerActiveStyle(layer) {\n        switch (layer.feature.geometry.type) {\n            case \"Point\":\n                layer.setStyle(objectsSettings.styles['on_dialog_point']);\n                break;\n            case \"MultiLineString\":\n                layer.setStyle(objectsSettings.styles['on_dialog_line']);\n                break;\n            case \"Polygon\":\n                layer.setStyle(objectsSettings.styles['on_dialog_polygon']);\n                break;\n        }\n    }\n})();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hc3NldHMvZnJvbnQvanMvbWFwLW1pbmkuanM/ZTE1ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge21hcEJveEF0dHJpYnV0aW9uLCBtYXBCb3hVcmx9IGZyb20gJy4vbWFwLWNvbmZpZyc7XG5cbigoKSA9PiB7XG5cbiAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXBNaW5pJykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBsb2FkaW5nID0gJCgnLmxvYWRpbmcnKTtcbiAgICBjb25zdCBjb25maXJtTW9kYWwgPSAkKCcuY29uZmlybScpO1xuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdbZGF0YS1jb25maXJtLWNhbmNlbF0nLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJlbW92ZUFsbFBvcHVwcygpO1xuICAgIH0pO1xuXG4gICAgLy9jb25zdCBtYXBDZW50ZXIgPSBtYXBPcHRpb24uY2VudGVyO1xuICAgIC8vY29uc3QgbWFwWm9vbSA9IG1hcE9wdGlvbi56b29tO1xuXG4gICAgY29uc3QgZGVmYXVsdE9iamVjdFN0eWxlID0ge1xuICAgICAgICBjb2xvcjogXCIjZmY5NzEwXCIsXG4gICAgICAgIG9wYWNpdHk6IDAuNSxcbiAgICAgICAgd2lkdGg6IDVcbiAgICB9O1xuICAgIGxldCBvYmplY3RzU2V0dGluZ3MgPSB7fTtcbiAgICBsZXQgaW5pdGlhbExvYWQgPSBmYWxzZTtcblxuICAgIGxldCBtYXAgPSBuZXcgTC5tYXAoJ21hcE1pbmknLCB7XG4gICAgICAgIHVwZGF0ZVdoZW5ab29taW5nOiBmYWxzZSxcbiAgICAgICAgYXR0cmlidXRpb25Db250cm9sOiBmYWxzZVxuICAgIH0pO1xuXG4gICAgbGV0IG1hcFN0eWxlID0gTC50aWxlTGF5ZXIobWFwQm94VXJsLCB7XG4gICAgICAgIGF0dHJpYnV0aW9uOiBtYXBCb3hBdHRyaWJ1dGlvbixcbiAgICAgICAgbWF4TmF0aXZlWm9vbTogMTksXG4gICAgICAgIG1heFpvb206IDIxLFxuICAgICAgICBtaW5ab29tOiAxMSxcbiAgICAgICAgdXBkYXRlV2hlblpvb21pbmc6IGZhbHNlXG4gICAgfSk7XG4gICAgbWFwU3R5bGUuYWRkVG8obWFwKTtcblxuICAgIGxldCBteUxvY2F0aW9uQnV0dG9uID0gTC5Db250cm9sLmV4dGVuZCh7XG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wbGVmdCdcbiAgICAgICAgfSxcbiAgICAgICAgb25BZGQ6ICgpID0+IHtcbiAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBMLkRvbVV0aWwuY3JlYXRlKCdidXR0b24nLCAnbGVhZmxldC1iYXIgbGVhZmxldC1jb250cm9sLWN1c3RvbSBmYXIgZmEtZG90LWNpcmNsZScpO1xuICAgICAgICAgICAgY29udGFpbmVyLnR5cGUgPSBcImJ1dHRvblwiO1xuICAgICAgICAgICAgY29udGFpbmVyLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbG9jYXRlKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRhaW5lcjtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIG1hcC5hZGRDb250cm9sKG5ldyBteUxvY2F0aW9uQnV0dG9uKCkpO1xuXG4gICAgbGV0IG15TG9jYXRpb25MYXllckdyb3VwID0gTC5sYXllckdyb3VwKCk7XG4gICAgbXlMb2NhdGlvbkxheWVyR3JvdXAuYWRkVG8obWFwKTtcblxuICAgIGxldCBwb3B1c0xheWVyR3JvdXAgPSBMLmxheWVyR3JvdXAoKTtcbiAgICBwb3B1c0xheWVyR3JvdXAuYWRkVG8obWFwKTtcblxuICAgIGxldCB1cGRhdGVNYXBUaHJvdHRsZTtcbiAgICBtYXAub24oJ2RyYWdlbmQgem9vbWVuZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHVwZGF0ZU1hcFRocm90dGxlKTtcbiAgICAgICAgdXBkYXRlTWFwVGhyb3R0bGUgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGxldCBjZW50ZXIgPSBtYXAuZ2V0Q2VudGVyKCk7XG5cbiAgICAgICAgICAgIHVwZGF0ZU1hcChjZW50ZXIsICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWluaXRpYWxMb2FkKSB7XG4gICAgICAgICAgICAgICAgICAgIGluaXRpYWxMb2FkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQoJyNtYXBNaW5pJykuZGF0YSgnbG9jYXRlLW9uLWxvYWQnKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9LCAyMDApO1xuICAgIH0pO1xuXG4gICAgbWFwLm9uKCdsb2NhdGlvbmZvdW5kJywgc2V0TWFwVmlld1RvTXlMb2NhdGlvbik7XG4gICAgbWFwLm9uKCdsb2NhdGlvbmVycm9yJywgc2V0SW5pdGlhbE1hcFZpZXcpO1xuXG4gICAgbGV0IGdlb0pzb25MYXllciA9IEwuZ2VvSlNPTihbXSwge1xuICAgICAgICBzdHlsZTogZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgICAgICAgICAgIHJldHVybiBvYmplY3RzU2V0dGluZ3Muc3R5bGVzW2ZlYXR1cmUucHJvcGVydGllcy5fczFdID8gey4uLm9iamVjdHNTZXR0aW5ncy5zdHlsZXNbZmVhdHVyZS5wcm9wZXJ0aWVzLl9zMV19IDogey4uLmRlZmF1bHRPYmplY3RTdHlsZX1cbiAgICAgICAgfSxcbiAgICAgICAgb25FYWNoRmVhdHVyZTogZnVuY3Rpb24gKGZlYXR1cmUsIGxheWVyKSB7XG4gICAgICAgICAgICBsYXllci5vbignY2xpY2snLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGZlYXR1cmUucHJvcGVydGllcy5fYmVoYXZpb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm5hdmlnYXRpb25cIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHpvb21Ub0xheWVyKGxheWVyLCBldik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5MYXllclBvcHVwKGxheWVyLCBldik7XG4gICAgICAgICAgICAgICAgICAgICAgICB6b29tVG9MYXllcihsYXllciwgZXYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBsYXllci5vbignbW91c2VvdmVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuYWN0aXZlUG9wdXApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAob2JqZWN0c1NldHRpbmdzLnN0eWxlc1tmZWF0dXJlLnByb3BlcnRpZXMuX3MyXSkge1xuICAgICAgICAgICAgICAgICAgICBzZXRMYXllckhvdmVyU3R5bGUobGF5ZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbGF5ZXIub24oJ21vdXNlb3V0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuYWN0aXZlUG9wdXApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAob2JqZWN0c1NldHRpbmdzLnN0eWxlc1tmZWF0dXJlLnByb3BlcnRpZXMuX3MxXSkge1xuICAgICAgICAgICAgICAgICAgICBzZXRMYXllckRlZmF1bHRTdHlsZShsYXllcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIHBvaW50VG9MYXllcjogZnVuY3Rpb24gKGZlYXR1cmUsIGxhdGxuZykge1xuICAgICAgICAgICAgcmV0dXJuIEwuY2lyY2xlTWFya2VyKGxhdGxuZywgb2JqZWN0c1NldHRpbmdzLnN0eWxlc1tmZWF0dXJlLnByb3BlcnRpZXMuX3MxXSk7XG4gICAgICAgIH1cbiAgICB9KS5hZGRUbyhtYXApO1xuXG4gICAgc2V0SW5pdGlhbE1hcFZpZXcoKTtcbiAgICBnZW9Db2xsZWN0aW9uKCk7XG5cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZU1hcChjZW50ZXIsIGZuID0gKCkgPT4ge1xuICAgIH0pIHtcbiAgICAgICAgbGV0IHpvb20gPSBtYXAuZ2V0Wm9vbSgpO1xuICAgICAgICBsZXQgYm91bmRzID0gbWFwLmdldEJvdW5kcygpO1xuICAgICAgICBsZXQgcmV0dXJuZWRUYXJnZXQgPSB7fTtcblxuICAgICAgICBsZXQgYSA9IHtcbiAgICAgICAgICAgIGluOiBib3VuZHMuX3NvdXRoV2VzdC5sbmcgKyAnLCcgK1xuICAgICAgICAgICAgICAgIGJvdW5kcy5fbm9ydGhFYXN0LmxhdCArICcsJyArXG4gICAgICAgICAgICAgICAgYm91bmRzLl9ub3J0aEVhc3QubG5nICsgJywnICtcbiAgICAgICAgICAgICAgICBib3VuZHMuX3NvdXRoV2VzdC5sYXQgKyAnLCcsXG4gICAgICAgICAgICB6b29tOiB6b29tLFxuICAgICAgICAgICAgYzogY2VudGVyLmxhdCArICcsJyArIGNlbnRlci5sbmcsXG4gICAgICAgICAgICBnOiBtYXBPcHRpb24uY29sbGVjdGlvblxuICAgICAgICB9O1xuXG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHJldHVybmVkVGFyZ2V0ID0gT2JqZWN0LmFzc2lnbihhLCBiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybmVkVGFyZ2V0ID0gYTtcbiAgICAgICAgfVxuXG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICBkYXRhOiByZXR1cm5lZFRhcmdldCxcbiAgICAgICAgICAgIHVybDogXCIvZnJvbnQtZW5kL21hcD9cIixcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgb2JqZWN0c1NldHRpbmdzID0gcmVzdWx0cy5zZXR0aW5ncztcbiAgICAgICAgICAgICAgICBnZW9Kc29uTGF5ZXIuY2xlYXJMYXllcnMoKTtcbiAgICAgICAgICAgICAgICBnZW9Kc29uTGF5ZXIuYWRkRGF0YShyZXN1bHRzLm9iamVjdHMpO1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcC5maXRCb3VuZHMocmVzdWx0cy5iYm94LCB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBmbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzYXZlVmlld3BvcnQoY2VudGVyKSB7XG4gICAgICAgIGxldCB6b29tID0gbWFwLmdldFpvb20oKTtcbiAgICAgICAgbGV0IGEgPSB7XG4gICAgICAgICAgICB6b29tOiB6b29tLFxuICAgICAgICAgICAgYzogY2VudGVyLmxhdCArICcsJyArIGNlbnRlci5sbmdcbiAgICAgICAgfTtcblxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgZGF0YTogYSxcbiAgICAgICAgICAgIHVybDogXCIvbWFwL3pcIixcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHtcblxuXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvY2F0ZSgpIHtcbiAgICAgICAgbG9hZGluZy5yZW1vdmVDbGFzcygnZC1ub25lJyk7XG4gICAgICAgIG1hcC5sb2NhdGUoe1xuICAgICAgICAgICAgc2V0VmlldzogdHJ1ZSxcbiAgICAgICAgICAgIG1heFpvb206IG9iamVjdHNTZXR0aW5ncy5kZWZhdWx0X3pvb21cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0TWFwVmlld1RvTXlMb2NhdGlvbihlKSB7XG4gICAgICAgIGxvYWRpbmcuYWRkQ2xhc3MoJ2Qtbm9uZScpO1xuICAgICAgICBsZXQgcmFkaXVzID0gZS5hY2N1cmFjeSAvIDI7XG5cbiAgICAgICAgbXlMb2NhdGlvbkxheWVyR3JvdXAuZWFjaExheWVyKChsYXllcikgPT4ge1xuICAgICAgICAgICAgbXlMb2NhdGlvbkxheWVyR3JvdXAucmVtb3ZlTGF5ZXIobGF5ZXIpO1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgY2VudGVyID0gTC5jaXJjbGUoZS5sYXRsbmcsIHtcbiAgICAgICAgICAgIGNvbG9yOiAnI2ZmZicsXG4gICAgICAgICAgICBmaWxsQ29sb3I6ICcjMkE5M0VFJyxcbiAgICAgICAgICAgIGZpbGxPcGFjaXR5OiAxLFxuICAgICAgICAgICAgd2VpZ2h0OiA0LFxuICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgIHJhZGl1czogNVxuICAgICAgICB9KS5hZGRUbyhteUxvY2F0aW9uTGF5ZXJHcm91cCk7XG5cbiAgICAgICAgTC5jaXJjbGUoZS5sYXRsbmcsIHtcbiAgICAgICAgICAgIHJhZGl1czogZS5hY2N1cmFjeSAvIDIsXG4gICAgICAgICAgICBjb2xvcjogJyMxMzZBRUMnLFxuICAgICAgICAgICAgZmlsbENvbG9yOiAnIzEzNkFFQycsXG4gICAgICAgICAgICBmaWxsT3BhY2l0eTogMC4xNSxcbiAgICAgICAgICAgIHdlaWdodDogMFxuICAgICAgICB9KS5hZGRUbyhteUxvY2F0aW9uTGF5ZXJHcm91cCk7XG5cbiAgICAgICAgY2VudGVyLmJpbmRQb3B1cChcItCd0LDQvNC40YDQsNGC0LUg0YHQtSDQsiDRgNCw0LTQuNGD0YEg0L7RgiBcIiArIHJhZGl1cyArIFwiINC80LXRgtGA0LAg0L7RgiDRgtCw0LfQuCDQu9C+0LrQsNGG0LjRj1wiLCB7XG4gICAgICAgICAgICBvZmZzZXQ6IEwucG9pbnQoMCwgLTEwKVxuICAgICAgICB9KTtcbiAgICAgICAgY2VudGVyLm9wZW5Qb3B1cCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldEluaXRpYWxNYXBWaWV3KCkge1xuICAgICAgICBsb2FkaW5nLmFkZENsYXNzKCdkLW5vbmUnKTtcblxuICAgICAgICBsZXQgem9vbTtcbiAgICAgICAgbGV0IGxhdDtcbiAgICAgICAgbGV0IGxuZztcblxuICAgICAgICBpZiAodHlwZW9mIG1hcE9wdGlvbi5iYm94ID09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgIG1hcC5maXRCb3VuZHMobWFwT3B0aW9uLmJib3gsIHt9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgdXJsOiBcIi9tYXAvcFwiLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgICAgIHpvb20gPSByZXN1bHRzLnpvb207XG4gICAgICAgICAgICAgICAgICAgIGxhdCA9IHJlc3VsdHMubGF0O1xuICAgICAgICAgICAgICAgICAgICBsbmcgPSByZXN1bHRzLmxuZztcblxuICAgICAgICAgICAgICAgICAgICBzZXRSZWFsSW5pdGlhbE1hcFZpZXcobGF0LCBsbmcsIHpvb20pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0UmVhbEluaXRpYWxNYXBWaWV3KGxhdCwgbG5nLCB6b29tKSB7XG4gICAgICAgIG1hcC5zZXRWaWV3KFtsYXQsIGxuZ10sIHpvb20pXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gem9vbVRvTGF5ZXIobGF5ZXIsIGV2KSB7XG4gICAgICAgIGxldCBjbGlja0Nvb3JkaW5hdGVzID0gbWFwLm1vdXNlRXZlbnRUb0xhdExuZyhldi5vcmlnaW5hbEV2ZW50KTtcbiAgICAgICAgaWYgKGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5fem9vbSAmJiBsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuX3pvb20gIT09IG1hcC5nZXRab29tKCkpIHtcbiAgICAgICAgICAgIG1hcC5zZXRWaWV3KGNsaWNrQ29vcmRpbmF0ZXMsIGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5fem9vbSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtYXAuc2V0VmlldyhjbGlja0Nvb3JkaW5hdGVzKTtcblxuICAgICAgICAgICAgc2F2ZVZpZXdwb3J0KGNsaWNrQ29vcmRpbmF0ZXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb3BlbkxheWVyUG9wdXAobGF5ZXIsIGV2KSB7XG4gICAgICAgIHNldExheWVyQWN0aXZlU3R5bGUobGF5ZXIpO1xuICAgICAgICByZW1vdmVBbGxQb3B1cHMoKTtcbiAgICAgICAgbGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLmFjdGl2ZVBvcHVwID0gdHJ1ZTtcblxuICAgICAgICBsZXQgY29vcmRpbmF0ZXM7XG5cblxuICAgICAgICBpZiAobGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLl9iZWhhdmlvciA9PT0gJ3N1cnZleScpIHtcbiAgICAgICAgICAgIGNvb3JkaW5hdGVzID0gbWFwLm1vdXNlRXZlbnRUb0xhdExuZyhldi5vcmlnaW5hbEV2ZW50KTtcbiAgICAgICAgICAgIGlmIChtYXBPcHRpb24uc3VydmV5ID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgb3BlbkNvbmZpcm1Nb2RhbChsYXllcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb29yZGluYXRlcyA9IGV2LmxhdGxuZztcbiAgICAgICAgfVxuXG5cbiAgICAgICAgbGV0IHBvcHVwTGF5ZXIgPSBMLmNpcmNsZShjb29yZGluYXRlcywge1xuICAgICAgICAgICAgZmlsbE9wYWNpdHk6IDAsXG4gICAgICAgICAgICB3ZWlnaHQ6IDAsXG4gICAgICAgICAgICBvcGFjaXR5OiAwLFxuICAgICAgICAgICAgcmFkaXVzOiAxXG4gICAgICAgIH0pLmFkZFRvKHBvcHVzTGF5ZXJHcm91cCk7XG5cbiAgICAgICAgbGV0IHBvcHVwQ29udGVudCA9IGA8cCBjbGFzcz1cInRleHQtY2VudGVyXCI+PCEtLTxmb3JtIG1ldGhvZD1cInBvc3RcIiBjbGFzcz1cIm0tZm9ybVwiIGFjdGlvbj1cIi9mcm9udC1lbmQvZ2VvLWNvbGxlY3Rpb24vYWRkXCI+PGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwiZ2VvLW9iamVjdFwiIHZhbHVlPVwiJHtsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuaWR9XCI+PGJ1dHRvbiB0eXBlPVwic3VibWl0XCI+JHtsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuaWR9PC9idXR0b24+PC9mb3JtPi0tPiR7bGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLnR5cGV9PGJyIC8+JHtsYXllci5mZWF0dXJlLnByb3BlcnRpZXMubmFtZX08L3A+YDtcblxuICAgICAgICBwb3B1cExheWVyLmJpbmRQb3B1cChwb3B1cENvbnRlbnQsIHtcbiAgICAgICAgICAgIG9mZnNldDogTC5wb2ludCgwLCAtMjApXG4gICAgICAgIH0pLm9uKCdwb3B1cGNsb3NlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uZmlybU1vZGFsLmFkZENsYXNzKCdkLW5vbmUnKTtcbiAgICAgICAgICAgIGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5hY3RpdmVQb3B1cCA9IGZhbHNlO1xuICAgICAgICAgICAgc2V0TGF5ZXJEZWZhdWx0U3R5bGUobGF5ZXIpO1xuICAgICAgICAgICAgcmVtb3ZlQWxsUG9wdXBzKCk7XG4gICAgICAgIH0pLm9wZW5Qb3B1cCgpO1xuXG4gICAgICAgIGxldCBjb2xsZWN0aW9uID0gbWFwT3B0aW9uLmNvbGxlY3Rpb247XG5cbiAgICAgICAgaWYgKHR5cGVvZiBjb2xsZWN0aW9uICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcbiAgICAgICAgICAgICAgICB1cmw6ICcvZnJvbnQtZW5kL2dlby1jb2xsZWN0aW9uL2FkZCcsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAnZ2VvLW9iamVjdCc6IGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5pZCxcbiAgICAgICAgICAgICAgICAgICAgJ2NvbGxlY3Rpb24nOiBjb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjZW50ZXIgPSBtYXAuZ2V0Q2VudGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZU1hcChjZW50ZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBnZW9Db2xsZWN0aW9uKCk7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8qXG4gICAgICAgICAgICAgICAgJChcIi5tLWZvcm1cIikuc3VibWl0KGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvcm0gPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gZm9ybS5hdHRyKCdhY3Rpb24nKTtcblxuICAgICAgICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvZnJvbnQtZW5kL2dlby1jb2xsZWN0aW9uL2FkZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2RhdGE6IGZvcm0uc2VyaWFsaXplKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2dlby1vYmplY3QnOiAnY2Q1MzhiZjUtMzIyMC00MjU5LWIyNmQtMzQ4OGQ3MWNhN2Q3J1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVNYXAoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAqL1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdlb0NvbGxlY3Rpb24oKSB7XG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB1cmw6IFwiL2dlby1jb2xsZWN0aW9uL2luZm9cIixcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBsZXQgaHRtbCA9IGA8dWwgY2xhc3M9XCJtdC00IHBsLTRcIj5gO1xuXG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMocmVzdWx0KS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gYDxsaSBjbGFzcz1cIm1iLTJcIj5cblx0XHRcdFx0XHRcdFx0PGEgaHJlZj1cIi9nZW8tY29sbGVjdGlvbi8ke3Jlc3VsdFtpdGVtXS5jb2xsZWN0aW9uX3V1aWR9XCIgY2xhc3M9XCJmb250LXdlaWdodC1ib2xkXCI+0JzQsNGA0YjRgNGD0YI8L2E+YDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBnY09wZW4gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2NPcGVuID09PSByZXN1bHRbaXRlbV0uY29sbGVjdGlvbl91dWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBgIFs8c3BhbiBjbGFzcz1cInRleHQtc3VjY2Vzc1wiPtCw0LrRgtC40LLQtdC9PC9zcGFuPl1cblx0XHRcdFx0XHRcdFx0PGZvcm0gbWV0aG9kPVwicG9zdFwiIGNsYXNzPVwiZmxvYXQtcmlnaHRcIj5cblx0XHRcdFx0XHRcdFx0ICAgIDxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgbmFtZT1cIl9tZXRob2RcIiB2YWx1ZT1cImRlbGV0ZVwiPlxuXHRcdFx0XHRcdFx0XHRcdDxidXR0b24gdHlwZT1cInN1Ym1pdFwiIGNsYXNzPVwiYnRuIGJ0bi1zbSBidG4tZGFuZ2VyXCIgc3R5bGU9XCJmb250LXNpemU6IDExcHg7IHBhZGRpbmc6IDRweCA1cHggMFwiPjxpIGNsYXNzPVwiZmEgZmEtdHJhc2hcIj48L2k+IDwvYnV0dG9uPlxuXHRcdFx0XHRcdFx0XHQ8L2Zvcm0+YDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBgPGRpdj5cblx0XHRcdFx0XHRcdFx00LTRitC70LbQuNC90LA6ICR7cmVzdWx0W2l0ZW1dLmxlbmd0aH0g0Lw8YnIgLz5cblx0XHRcdFx0XHRcdFx00L7RhtC10L3QtdC9OiAke3Jlc3VsdFtpdGVtXS5jb21wbGV0aW9uLnBlcmNlbnRhZ2V9ICU8YnIgLz5cblx0XHRcdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwicHJvZ3Jlc3NcIiBzdHlsZT1cImhlaWdodDogM3B4O1wiPlxuXHRcdFx0XHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cInByb2dyZXNzLWJhclwiIHJvbGU9XCJwcm9ncmVzc2JhclwiIHN0eWxlPVwid2lkdGg6ICR7cmVzdWx0W2l0ZW1dLmNvbXBsZXRpb24ucGVyY2VudGFnZX0lO1wiIGFyaWEtdmFsdWVub3c9XCIyNVwiIGFyaWEtdmFsdWVtaW49XCIwXCIgYXJpYS12YWx1ZW1heD1cIjEwMFwiPjwvZGl2PlxuXHRcdFx0XHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHRcdDwvbGk+YDtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGh0bWwgKz0gYDwvdWw+YDtcblxuICAgICAgICAgICAgICAgICQoXCIjZGl2M1wiKS5odG1sKGh0bWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvcGVuQ29uZmlybU1vZGFsKGxheWVyKSB7XG4gICAgICAgIGxldCBkaWFsb2dUaXRsZSA9IG9iamVjdHNTZXR0aW5ncy5kaWFsb2dbbGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLl9kdGV4dF0gfHwgJ9CY0YHQutCw0YLQtSDQu9C4INC00LAg0L7RhtC10L3QuNGC0LUnO1xuICAgICAgICBsZXQgZGlhbG9nTGluayA9ICcvZ2VvLycgKyBsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuaWQ7XG4gICAgICAgIGNvbmZpcm1Nb2RhbC5yZW1vdmVDbGFzcygnZC1ub25lJyk7XG4gICAgICAgIGNvbmZpcm1Nb2RhbC5maW5kKCdbZGF0YS1jb25maXJtLXRpdGxlXScpLmh0bWwoYCR7ZGlhbG9nVGl0bGV9P2ApO1xuICAgICAgICBjb25maXJtTW9kYWwuZmluZCgnW2RhdGEtY29uZmlybS1saW5rXScpLmF0dHIoJ2hyZWYnLCBkaWFsb2dMaW5rKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW1vdmVBbGxQb3B1cHMoKSB7XG4gICAgICAgIG1hcC5jbG9zZVBvcHVwKCk7XG4gICAgICAgIHBvcHVzTGF5ZXJHcm91cC5lYWNoTGF5ZXIoKGxheWVyKSA9PiB7XG4gICAgICAgICAgICBwb3B1c0xheWVyR3JvdXAucmVtb3ZlTGF5ZXIobGF5ZXIpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRMYXllckRlZmF1bHRTdHlsZShsYXllcikge1xuICAgICAgICBsYXllci5zZXRTdHlsZShvYmplY3RzU2V0dGluZ3Muc3R5bGVzW2xheWVyLmZlYXR1cmUucHJvcGVydGllcy5fczFdIHx8IGRlZmF1bHRPYmplY3RTdHlsZSlcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRMYXllckhvdmVyU3R5bGUobGF5ZXIpIHtcbiAgICAgICAgbGF5ZXIuc2V0U3R5bGUob2JqZWN0c1NldHRpbmdzLnN0eWxlc1tsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuX3MyXSlcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRMYXllckFjdGl2ZVN0eWxlKGxheWVyKSB7XG4gICAgICAgIHN3aXRjaCAobGF5ZXIuZmVhdHVyZS5nZW9tZXRyeS50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFwiUG9pbnRcIjpcbiAgICAgICAgICAgICAgICBsYXllci5zZXRTdHlsZShvYmplY3RzU2V0dGluZ3Muc3R5bGVzWydvbl9kaWFsb2dfcG9pbnQnXSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiTXVsdGlMaW5lU3RyaW5nXCI6XG4gICAgICAgICAgICAgICAgbGF5ZXIuc2V0U3R5bGUob2JqZWN0c1NldHRpbmdzLnN0eWxlc1snb25fZGlhbG9nX2xpbmUnXSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiUG9seWdvblwiOlxuICAgICAgICAgICAgICAgIGxheWVyLnNldFN0eWxlKG9iamVjdHNTZXR0aW5ncy5zdHlsZXNbJ29uX2RpYWxvZ19wb2x5Z29uJ10pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBhc3NldHMvZnJvbnQvanMvbWFwLW1pbmkuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQWFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbkNBO0FBQ0E7QUFxQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBUEE7QUFDQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFLQTtBQUNBO0FBYkE7QUFlQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFDQTtBQU9BO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQUNBO0FBWUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWhDQTtBQWtDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQVdBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///3\n");

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n(function () {\n    var surveayForm = $('#survayForm');\n\n    function getQuestions() {\n\n        $.ajax({\n            url: '/geo/' + geoObject + '/q',\n            success: function success(result) {\n                onSuccess(result);\n            }\n        });\n    }\n\n    getQuestions();\n\n    var timeoutId = void 0;\n\n    $(document).on('input propertychange', '.answer', function () {\n        var data = {};\n        var debounceTime = 0;\n\n        if (this.tagName === 'TEXTAREA') {\n            data = {\n                'explanation': {\n                    \"answer\": this.id,\n                    \"text\": this.value\n                }\n            };\n\n            debounceTime = 400;\n        } else {\n            data = {\n                'answer': this.value\n            };\n        }\n\n        clearTimeout(timeoutId);\n\n        timeoutId = setTimeout(function () {\n            submitSurvay(data, this.value);\n        }, debounceTime);\n    });\n\n    function submitSurvay(data, value) {\n        $.ajax({\n            type: 'POST',\n            url: '/geo/' + geoObject + '/q',\n            data: data,\n            beforeSend: function beforeSend() {\n                if (document.getElementById(value)) {\n                    document.getElementById(value).style.color = \"green\";\n                }\n            },\n            success: function success(result) {\n                onSuccess(result);\n            }\n        });\n    }\n\n    function onSuccess(result) {\n        var html = '';\n        var survey = result.survey;\n        var progress = result.progress;\n        var isSelectedParent = false;\n\n        Object.keys(survey).forEach(function (item) {\n            var answers = survey[item].answers;\n            var question = survey[item];\n\n            html += '<div class=\"survay-question mb-4\">\\n                        <div class=\"survay-question-title  mb-1\">\\n                            <i class=\"mr-1 fas ' + (question.isAnswered ? 'text-success fa-check' : 'fa-check text-black-50') + '\"></i>\\n                            <h5 class=\"survay-question-title-text d-inline\">' + question.title + '</h5>\\n                        </div>\\n                        <div class=\"survay-question pl-4\">';\n\n            Object.keys(answers).forEach(function (answer) {\n                if (answers[answer].parent === null) {\n                    isSelectedParent = question.answers[answer].isSelected;\n\n                    html += '<div class=\"d-flex flex-column\">\\n                                <label class=\"survay-question-option ' + (answers[answer].isSelected ? 'is-answered' : '') + '\" id=\"' + answers[answer].uuid + '\">\\n                                    <input class=\"mr-1 answer\" type=\"' + (question.hasMultipleAnswers ? 'checkbox' : 'radio') + '\" name=\"answers[option][' + question.uuid + '][]\"\\n                                    ' + (answers[answer].isSelected ? 'checked=\"checked\"' : '') + ' value=\"' + answers[answer].uuid + '\" /> ' + answers[answer].title + '\\n                                </label>\\n                            </div>';\n\n                    if (question.answers[answer].isFreeAnswer) {\n                        html += '<textarea class=\"answer\"></textarea>';\n                    }\n                } else {\n                    if (isSelectedParent === true) {\n                        html += '<div class=\"pl-4 d-flex flex-column\">\\n                                    <label class=\"survay-question-option ' + (answers[answer].isSelected ? 'is-answered' : '') + '\" id=\"' + answers[answer].uuid + '\">\\n                                        <input class=\"mr-1  answer\" type=\"checkbox\" name=\"answers[option][' + question.uuid + '][]\"' + (answers[answer].isSelected ? 'checked=\"checked\"' : '') + ' value=\"' + answers[answer].uuid + '\" />\\n                                        ' + answers[answer].title + '</label>';\n\n                        if (answers[answer].isSelected && question.answers[answer].isFreeAnswer) {\n                            html += '<label class=\"' + (answers[answer].isSelected ? 'is-answered' : '') + '\">\\n                                        <textarea class=\"answer d-block\" id=\"textarea-' + question.answers[answer].uuid + ']\">' + question.answers[answer].explanation + '</textarea>\\n                                    </label>';\n                        }\n\n                        html += '</div>';\n                    }\n                }\n            });\n\n            if (question.isAnswered) {\n                html += '<div class=\"d-flex justify-content-end\">\\n                            <button type=\"button\" class=\"rem btn btn-sm btn-danger\" name=\"answers[option][' + question.uuid + '][]\" value=\"' + question.uuid + '\">\\u0418\\u0437\\u0447\\u0438\\u0441\\u0442\\u0438</button>\\n                        </div>';\n            }\n\n            html += '\\n                        </div>\\n                    </div>\\n                    ';\n        });\n\n        surveayForm.html(html);\n\n        var progressbar = '<div class=\"progress mb-4\">\\n                            <div class=\"progress-bar ' + (progress.percentage === 100 ? 'bg-success' : '') + '\" role=\"progressbar\" style=\"width: ' + progress.percentage + '%;\"\\n                                 aria-valuenow=\"' + progress.percentage + '\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\\n                        </div>';\n\n        $(\"#surveyProgressBar\").html(progressbar);\n    }\n\n    $(document).on('click', '.rem', function () {\n        var value = this.value;\n        $.ajax({\n            type: \"POST\",\n            url: '/geo/' + geoObject + '/clear/' + value,\n\n            success: function success() {\n                getQuestions();\n            }\n        });\n    });\n})();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hc3NldHMvZnJvbnQvanMvc3VydmV5LmpzPzU1NTMiXSwic291cmNlc0NvbnRlbnQiOlsiKCgpID0+IHtcbiAgICBjb25zdCBzdXJ2ZWF5Rm9ybSA9ICQoJyNzdXJ2YXlGb3JtJyk7XG5cbiAgICBmdW5jdGlvbiBnZXRRdWVzdGlvbnMoKSB7XG5cbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIHVybDogJy9nZW8vJyArIGdlb09iamVjdCArICcvcScsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICBvblN1Y2Nlc3MocmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZ2V0UXVlc3Rpb25zKCk7XG5cbiAgICBsZXQgdGltZW91dElkO1xuXG4gICAgJChkb2N1bWVudCkub24oJ2lucHV0IHByb3BlcnR5Y2hhbmdlJywgJy5hbnN3ZXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCBkYXRhID0ge307XG4gICAgICAgIGxldCBkZWJvdW5jZVRpbWUgPSAwO1xuXG4gICAgICAgIGlmICh0aGlzLnRhZ05hbWUgPT09ICdURVhUQVJFQScpIHtcbiAgICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgJ2V4cGxhbmF0aW9uJzoge1xuICAgICAgICAgICAgICAgICAgICBcImFuc3dlclwiOiB0aGlzLmlkLFxuICAgICAgICAgICAgICAgICAgICBcInRleHRcIjogdGhpcy52YWx1ZSxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBkZWJvdW5jZVRpbWUgPSA0MDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkYXRhID0gIHtcbiAgICAgICAgICAgICAgICAnYW5zd2VyJzogdGhpcy52YWx1ZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICBcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG5cbiAgICAgICAgdGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzdWJtaXRTdXJ2YXkoZGF0YSwgdGhpcy52YWx1ZSlcbiAgICAgICAgfSwgZGVib3VuY2VUaW1lKTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIHN1Ym1pdFN1cnZheShkYXRhLCB2YWx1ZSkge1xuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiAnL2dlby8nICsgZ2VvT2JqZWN0ICsgJy9xJyxcbiAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh2YWx1ZSkuc3R5bGUuY29sb3IgPSBcImdyZWVuXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBvblN1Y2Nlc3MocmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25TdWNjZXNzKHJlc3VsdCkge1xuICAgICAgICBsZXQgaHRtbCA9IGBgO1xuICAgICAgICBsZXQgc3VydmV5ID0gcmVzdWx0LnN1cnZleTtcbiAgICAgICAgbGV0IHByb2dyZXNzID0gcmVzdWx0LnByb2dyZXNzO1xuICAgICAgICBsZXQgaXNTZWxlY3RlZFBhcmVudCA9IGZhbHNlO1xuXG4gICAgICAgIE9iamVjdC5rZXlzKHN1cnZleSkuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgbGV0IGFuc3dlcnMgPSBzdXJ2ZXlbaXRlbV0uYW5zd2VycztcbiAgICAgICAgICAgIGxldCBxdWVzdGlvbiA9IHN1cnZleVtpdGVtXTtcblxuICAgICAgICAgICAgaHRtbCArPSBgPGRpdiBjbGFzcz1cInN1cnZheS1xdWVzdGlvbiBtYi00XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic3VydmF5LXF1ZXN0aW9uLXRpdGxlICBtYi0xXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJtci0xIGZhcyBgICsgKHF1ZXN0aW9uLmlzQW5zd2VyZWQgPyAndGV4dC1zdWNjZXNzIGZhLWNoZWNrJyA6ICdmYS1jaGVjayB0ZXh0LWJsYWNrLTUwJykgKyBgXCI+PC9pPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNSBjbGFzcz1cInN1cnZheS1xdWVzdGlvbi10aXRsZS10ZXh0IGQtaW5saW5lXCI+YCArIHF1ZXN0aW9uLnRpdGxlICsgYDwvaDU+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzdXJ2YXktcXVlc3Rpb24gcGwtNFwiPmA7XG5cbiAgICAgICAgICAgIE9iamVjdC5rZXlzKGFuc3dlcnMpLmZvckVhY2goZnVuY3Rpb24gKGFuc3dlcikge1xuICAgICAgICAgICAgICAgIGlmIChhbnN3ZXJzW2Fuc3dlcl0ucGFyZW50ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzU2VsZWN0ZWRQYXJlbnQgPSBxdWVzdGlvbi5hbnN3ZXJzW2Fuc3dlcl0uaXNTZWxlY3RlZDtcblxuICAgICAgICAgICAgICAgICAgICBodG1sICs9IGA8ZGl2IGNsYXNzPVwiZC1mbGV4IGZsZXgtY29sdW1uXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cInN1cnZheS1xdWVzdGlvbi1vcHRpb24gYCArIChhbnN3ZXJzW2Fuc3dlcl0uaXNTZWxlY3RlZCA/ICdpcy1hbnN3ZXJlZCcgOiAnJykgKyBgXCIgaWQ9XCJgICsgYW5zd2Vyc1thbnN3ZXJdLnV1aWQgKyBgXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJtci0xIGFuc3dlclwiIHR5cGU9XCJgICsgKHF1ZXN0aW9uLmhhc011bHRpcGxlQW5zd2VycyA/ICdjaGVja2JveCcgOiAncmFkaW8nKSArIGBcIiBuYW1lPVwiYW5zd2Vyc1tvcHRpb25dW2AgKyBxdWVzdGlvbi51dWlkICsgYF1bXVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgICsgKGFuc3dlcnNbYW5zd2VyXS5pc1NlbGVjdGVkID8gJ2NoZWNrZWQ9XCJjaGVja2VkXCInIDogJycpICsgYCB2YWx1ZT1cImAgKyBhbnN3ZXJzW2Fuc3dlcl0udXVpZCArIGBcIiAvPiBgICsgYW5zd2Vyc1thbnN3ZXJdLnRpdGxlICsgYFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmA7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHF1ZXN0aW9uLmFuc3dlcnNbYW5zd2VyXS5pc0ZyZWVBbnN3ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gYDx0ZXh0YXJlYSBjbGFzcz1cImFuc3dlclwiPjwvdGV4dGFyZWE+YDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1NlbGVjdGVkUGFyZW50ID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IGA8ZGl2IGNsYXNzPVwicGwtNCBkLWZsZXggZmxleC1jb2x1bW5cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cInN1cnZheS1xdWVzdGlvbi1vcHRpb24gYCArIChhbnN3ZXJzW2Fuc3dlcl0uaXNTZWxlY3RlZCA/ICdpcy1hbnN3ZXJlZCcgOiAnJykgKyBgXCIgaWQ9XCJgICsgYW5zd2Vyc1thbnN3ZXJdLnV1aWQgKyBgXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVwibXItMSAgYW5zd2VyXCIgdHlwZT1cImNoZWNrYm94XCIgbmFtZT1cImFuc3dlcnNbb3B0aW9uXVtgICsgcXVlc3Rpb24udXVpZCArIGBdW11cImAgKyAoYW5zd2Vyc1thbnN3ZXJdLmlzU2VsZWN0ZWQgPyAnY2hlY2tlZD1cImNoZWNrZWRcIicgOiAnJykgKyBgIHZhbHVlPVwiYCArIGFuc3dlcnNbYW5zd2VyXS51dWlkICsgYFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCArIGFuc3dlcnNbYW5zd2VyXS50aXRsZSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgPC9sYWJlbD5gO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5zd2Vyc1thbnN3ZXJdLmlzU2VsZWN0ZWQgJiYgcXVlc3Rpb24uYW5zd2Vyc1thbnN3ZXJdLmlzRnJlZUFuc3dlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gYDxsYWJlbCBjbGFzcz1cImAgKyAoYW5zd2Vyc1thbnN3ZXJdLmlzU2VsZWN0ZWQgPyAnaXMtYW5zd2VyZWQnIDogJycpICsgYFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBjbGFzcz1cImFuc3dlciBkLWJsb2NrXCIgaWQ9XCJ0ZXh0YXJlYS1gICsgcXVlc3Rpb24uYW5zd2Vyc1thbnN3ZXJdLnV1aWQgKyBgXVwiPmAgKyBxdWVzdGlvbi5hbnN3ZXJzW2Fuc3dlcl0uZXhwbGFuYXRpb24gKyBgPC90ZXh0YXJlYT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+YDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPC9kaXY+JztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAocXVlc3Rpb24uaXNBbnN3ZXJlZCkge1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gYDxkaXYgY2xhc3M9XCJkLWZsZXgganVzdGlmeS1jb250ZW50LWVuZFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwicmVtIGJ0biBidG4tc20gYnRuLWRhbmdlclwiIG5hbWU9XCJhbnN3ZXJzW29wdGlvbl1bYCArIHF1ZXN0aW9uLnV1aWQgKyBgXVtdXCIgdmFsdWU9XCJgICsgcXVlc3Rpb24udXVpZCArIGBcIj7QmNC30YfQuNGB0YLQuDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+YDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaHRtbCArPSBgXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIGA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHN1cnZlYXlGb3JtLmh0bWwoaHRtbCk7XG5cbiAgICAgICAgbGV0IHByb2dyZXNzYmFyID0gYDxkaXYgY2xhc3M9XCJwcm9ncmVzcyBtYi00XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInByb2dyZXNzLWJhciBgICsgKHByb2dyZXNzLnBlcmNlbnRhZ2UgPT09IDEwMCA/ICdiZy1zdWNjZXNzJyA6ICcnKSArIGBcIiByb2xlPVwicHJvZ3Jlc3NiYXJcIiBzdHlsZT1cIndpZHRoOiBgICsgcHJvZ3Jlc3MucGVyY2VudGFnZSArIGAlO1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmlhLXZhbHVlbm93PVwiYCArIHByb2dyZXNzLnBlcmNlbnRhZ2UgKyBgXCIgYXJpYS12YWx1ZW1pbj1cIjBcIiBhcmlhLXZhbHVlbWF4PVwiMTAwXCI+PC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gO1xuXG4gICAgICAgICQoXCIjc3VydmV5UHJvZ3Jlc3NCYXJcIikuaHRtbChwcm9ncmVzc2Jhcik7XG4gICAgfVxuXG4gICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5yZW0nLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCB2YWx1ZSA9IHRoaXMudmFsdWU7XG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcbiAgICAgICAgICAgIHVybDogJy9nZW8vJyArIGdlb09iamVjdCArICcvY2xlYXIvJyArIHZhbHVlLFxuXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0UXVlc3Rpb25zKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG59KSgpO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBhc3NldHMvZnJvbnQvanMvc3VydmV5LmpzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQURBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQWFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBRUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///4\n");

/***/ })
/******/ ]);