/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 1);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*const mapBoxUrl = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';*/\nvar mapBoxUrl = 'https://gradska-sreda.dreamradio.org/map/styles/vs/{z}/{x}/{y}.png';\nvar mapBoxAttribution = '&copy <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors';\n\nexports.mapBoxUrl = mapBoxUrl;\nexports.mapBoxAttribution = mapBoxAttribution;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hc3NldHMvZnJvbnQvanMvbWFwLWNvbmZpZy5qcz8xNWU1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qY29uc3QgbWFwQm94VXJsID0gJ2h0dHBzOi8ve3N9LnRpbGUub3BlbnN0cmVldG1hcC5vcmcve3p9L3t4fS97eX0ucG5nJzsqL1xuY29uc3QgbWFwQm94VXJsID0gJ2h0dHBzOi8vZ3JhZHNrYS1zcmVkYS5kcmVhbXJhZGlvLm9yZy9tYXAvc3R5bGVzL3ZzL3t6fS97eH0ve3l9LnBuZyc7XG5jb25zdCBtYXBCb3hBdHRyaWJ1dGlvbiA9IGAmY29weSA8YSBocmVmPVwiaHR0cHM6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvY29weXJpZ2h0XCI+T3BlblN0cmVldE1hcDwvYT4gY29udHJpYnV0b3JzYDtcblxuZXhwb3J0IHttYXBCb3hVcmwsIG1hcEJveEF0dHJpYnV0aW9ufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGFzc2V0cy9mcm9udC9qcy9tYXAtY29uZmlnLmpzIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n");

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n__webpack_require__(2);\n\n__webpack_require__(3);\n\n__webpack_require__(4);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hc3NldHMvZnJvbnQvanMvbWFpbi5qcz82NTJlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAnbWFwLW1haW4nXG5pbXBvcnQgJ21hcC1taW5pJ1xuaW1wb3J0ICdzdXJ2ZXknXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gYXNzZXRzL2Zyb250L2pzL21haW4uanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///1\n");

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _mapConfig = __webpack_require__(0);\n\n(function () {\n    if (!document.getElementById('mapMain')) {\n        return;\n    }\n    var loading = $('.loading');\n    var confirmModal = $('.confirm');\n    $(document).on('click', '[data-confirm-cancel]', function () {\n        removeAllPopups();\n    });\n\n    //const mapCenter = mapOption.center;\n    //const mapZoom = mapOption.zoom;\n\n    var defaultObjectStyle = {\n        color: \"#ff9710\",\n        opacity: 0.5,\n        width: 5\n    };\n    var objectsSettings = {};\n    var initialLoad = false;\n\n    var map = new L.map('mapMain', {\n        updateWhenZooming: false,\n        attributionControl: false\n    });\n\n    var mapStyle = L.tileLayer(_mapConfig.mapBoxUrl, {\n        attribution: _mapConfig.mapBoxAttribution,\n        maxNativeZoom: 19,\n        maxZoom: 21,\n        minZoom: 11,\n        updateWhenZooming: false\n    });\n    mapStyle.addTo(map);\n\n    var myLocationButton = L.Control.extend({\n        options: {\n            position: 'topleft'\n        },\n        onAdd: function onAdd() {\n            var container = L.DomUtil.create('button', 'leaflet-bar leaflet-control-custom far fa-dot-circle');\n            container.type = \"button\";\n            container.onclick = function () {\n                locate();\n            };\n            return container;\n        }\n    });\n    map.addControl(new myLocationButton());\n\n    var myLocationLayerGroup = L.layerGroup();\n    myLocationLayerGroup.addTo(map);\n\n    var popusLayerGroup = L.layerGroup();\n    popusLayerGroup.addTo(map);\n\n    var updateMapThrottle = void 0;\n    map.on('dragend zoomend', function () {\n        clearTimeout(updateMapThrottle);\n        updateMapThrottle = setTimeout(function () {\n            var center = map.getCenter();\n\n            updateMap(center, function () {\n                if (!initialLoad) {\n                    initialLoad = true;\n                    if ($('#mapMain').data('locate-on-load') === true) {\n                        locate();\n                    }\n                }\n            });\n        }, 200);\n    });\n\n    map.on('locationfound', setMapViewToMyLocation);\n    map.on('locationerror', setInitialMapView);\n\n    var geoJsonLayer = L.geoJSON([], {\n        style: function style(feature) {\n            var styles = objectsSettings.styles[feature.properties._s1] ? _extends({}, objectsSettings.styles[feature.properties._s1]) : _extends({}, defaultObjectStyle);\n            return styles;\n        },\n        onEachFeature: function onEachFeature(feature, layer) {\n            layer.on('click', function (ev) {\n                switch (feature.properties._behavior) {\n                    case \"navigation\":\n                        zoomToLayer(layer, ev);\n                        break;\n                    default:\n                        openLayerPopup(layer, ev);\n                        zoomToLayer(layer, ev);\n                        break;\n                }\n            });\n            layer.on('mouseover', function () {\n                if (layer.feature.properties.activePopup) {\n                    return;\n                }\n                if (objectsSettings.styles[feature.properties._s2]) {\n                    setLayerHoverStyle(layer);\n                }\n            });\n            layer.on('mouseout', function () {\n                if (layer.feature.properties.activePopup) {\n                    return;\n                }\n                if (objectsSettings.styles[feature.properties._s1]) {\n                    setLayerDefaultStyle(layer);\n                }\n            });\n        },\n        pointToLayer: function pointToLayer(feature, latlng) {\n            return L.circleMarker(latlng, objectsSettings.styles[feature.properties._s1]);\n        }\n    }).addTo(map);\n\n    setInitialMapView();\n\n    function updateMap(center) {\n        var fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};\n\n        var zoom = map.getZoom();\n        var bounds = map.getBounds();\n        var returnedTarget = {};\n\n        var a = {\n            in: bounds._southWest.lng + ',' + bounds._northEast.lat + ',' + bounds._northEast.lng + ',' + bounds._southWest.lat + ',',\n            zoom: zoom,\n            c: center.lat + ',' + center.lng\n        };\n\n        if (typeof b !== 'undefined') {\n            returnedTarget = Object.assign(a, b);\n        } else {\n            returnedTarget = a;\n        }\n\n        $.ajax({\n            data: returnedTarget,\n            url: \"/front-end/map?\",\n            success: function success(results) {\n                objectsSettings = results.settings;\n                geoJsonLayer.clearLayers();\n                geoJsonLayer.addData(results.objects);\n                fn();\n            }\n        });\n    }\n\n    function saveViewport(center) {\n        var zoom = map.getZoom();\n        var a = {\n            zoom: zoom,\n            c: center.lat + ',' + center.lng\n        };\n\n        $.ajax({\n            data: a,\n            url: \"/map/z\",\n            success: function success(results) {}\n        });\n    }\n\n    function locate() {\n        loading.removeClass('d-none');\n        map.locate({\n            setView: true,\n            maxZoom: objectsSettings.default_zoom\n        });\n    }\n\n    function setMapViewToMyLocation(e) {\n        loading.addClass('d-none');\n        var radius = e.accuracy / 2;\n\n        myLocationLayerGroup.eachLayer(function (layer) {\n            myLocationLayerGroup.removeLayer(layer);\n        });\n\n        var center = L.circle(e.latlng, {\n            color: '#fff',\n            fillColor: '#2A93EE',\n            fillOpacity: 1,\n            weight: 4,\n            opacity: 1,\n            radius: 5\n        }).addTo(myLocationLayerGroup);\n\n        L.circle(e.latlng, {\n            radius: e.accuracy / 2,\n            color: '#136AEC',\n            fillColor: '#136AEC',\n            fillOpacity: 0.15,\n            weight: 0\n        }).addTo(myLocationLayerGroup);\n\n        center.bindPopup(\"Намирате се в радиус от \" + radius + \" метра от тази локация\", {\n            offset: L.point(0, -10)\n        });\n        center.openPopup();\n    }\n\n    function setInitialMapView() {\n        loading.addClass('d-none');\n\n        var zoom = void 0;\n        var lat = void 0;\n        var lng = void 0;\n\n        $.ajax({\n            url: \"/map/p\",\n            success: function success(results) {\n                zoom = results.zoom;\n                lat = results.lat;\n                lng = results.lng;\n                setRealInitialMapView(lat, lng, zoom);\n            }\n        });\n    }\n\n    function setRealInitialMapView(lat, lng, zoom) {\n        map.setView([lat, lng], zoom);\n    }\n\n    function zoomToLayer(layer, ev) {\n        var clickCoordinates = map.mouseEventToLatLng(ev.originalEvent);\n        if (layer.feature.properties._zoom && layer.feature.properties._zoom !== map.getZoom()) {\n            map.setView(clickCoordinates, layer.feature.properties._zoom);\n        } else {\n            map.setView(clickCoordinates);\n\n            saveViewport(clickCoordinates);\n        }\n    }\n\n    function openLayerPopup(layer, ev) {\n        setLayerActiveStyle(layer);\n        removeAllPopups();\n        layer.feature.properties.activePopup = true;\n\n        var coordinates = void 0;\n\n        if (layer.feature.properties._behavior === 'survey') {\n            coordinates = map.mouseEventToLatLng(ev.originalEvent);\n            if (mapOption.survey === true) {\n                openConfirmModal(layer);\n            }\n        } else {\n            coordinates = ev.latlng;\n        }\n\n        var popupLayer = L.circle(coordinates, {\n            fillOpacity: 0,\n            weight: 0,\n            opacity: 0,\n            radius: 1\n        }).addTo(popusLayerGroup);\n\n        var popupContent = '<p class=\"text-center\"><!--<form method=\"post\" class=\"m-form\" action=\"/front-end/geo-collection/add\"><input type=\"hidden\" name=\"geo-object\" value=\"' + layer.feature.properties.id + '\"><button type=\"submit\">' + layer.feature.properties.id + '</button></form>-->' + layer.feature.properties.type + '<br />' + layer.feature.properties.name + '</p>';\n\n        popupLayer.bindPopup(popupContent, {\n            offset: L.point(0, -20)\n        }).on('popupclose', function () {\n            confirmModal.addClass('d-none');\n            layer.feature.properties.activePopup = false;\n            setLayerDefaultStyle(layer);\n            removeAllPopups();\n        }).openPopup();\n\n        var collection = mapOption.collection;\n\n        if (typeof collection !== 'undefined') {\n            $.ajax({\n                type: \"POST\",\n                url: '/front-end/geo-collection/add',\n                data: {\n                    'geo-object': layer.feature.properties.id,\n                    'collection': collection\n                },\n                success: function success() {\n                    updateMap();\n                }\n            });\n        }\n        /*\n                $(\".m-form\").submit(function(e) {\n                    var form = $(this);\n                    var url = form.attr('action');\n                     $.ajax({\n                        type: \"POST\",\n                        url: '/front-end/geo-collection/add',\n                        //data: form.serialize(),\n                        data: {\n                            'geo-object': 'cd538bf5-3220-4259-b26d-3488d71ca7d7'\n                        },\n                        success: function()\n                        {\n                            updateMap();\n                        }\n                    });\n                     e.preventDefault();\n                });\n        */\n    }\n\n    function openConfirmModal(layer) {\n        var dialogTitle = objectsSettings.dialog[layer.feature.properties._dtext] || 'Искате ли да оцените';\n        var dialogLink = '/geo/' + layer.feature.properties.id;\n        confirmModal.removeClass('d-none');\n        confirmModal.find('[data-confirm-title]').html(dialogTitle + '?');\n        confirmModal.find('[data-confirm-link]').attr('href', dialogLink);\n    }\n\n    function removeAllPopups() {\n        map.closePopup();\n        popusLayerGroup.eachLayer(function (layer) {\n            popusLayerGroup.removeLayer(layer);\n        });\n    }\n\n    function setLayerDefaultStyle(layer) {\n        layer.setStyle(objectsSettings.styles[layer.feature.properties._s1] || defaultObjectStyle);\n    }\n\n    function setLayerHoverStyle(layer) {\n        layer.setStyle(objectsSettings.styles[layer.feature.properties._s2]);\n    }\n\n    function setLayerActiveStyle(layer) {\n        switch (layer.feature.geometry.type) {\n            case \"Point\":\n                layer.setStyle(objectsSettings.styles['on_dialog_point']);\n                break;\n            case \"MultiLineString\":\n                layer.setStyle(objectsSettings.styles['on_dialog_line']);\n                break;\n            case \"Polygon\":\n                layer.setStyle(objectsSettings.styles['on_dialog_polygon']);\n                break;\n        }\n    }\n})();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hc3NldHMvZnJvbnQvanMvbWFwLW1haW4uanM/NzkzNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge21hcEJveEF0dHJpYnV0aW9uLCBtYXBCb3hVcmx9IGZyb20gJy4vbWFwLWNvbmZpZyc7XG5cbigoKSA9PiB7XG4gICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwTWFpbicpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbG9hZGluZyA9ICQoJy5sb2FkaW5nJyk7XG4gICAgY29uc3QgY29uZmlybU1vZGFsID0gJCgnLmNvbmZpcm0nKTtcbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnW2RhdGEtY29uZmlybS1jYW5jZWxdJywgZnVuY3Rpb24gKCkge1xuICAgICAgICByZW1vdmVBbGxQb3B1cHMoKTtcbiAgICB9KTtcblxuICAgIC8vY29uc3QgbWFwQ2VudGVyID0gbWFwT3B0aW9uLmNlbnRlcjtcbiAgICAvL2NvbnN0IG1hcFpvb20gPSBtYXBPcHRpb24uem9vbTtcblxuICAgIGNvbnN0IGRlZmF1bHRPYmplY3RTdHlsZSA9IHtcbiAgICAgICAgY29sb3I6IFwiI2ZmOTcxMFwiLFxuICAgICAgICBvcGFjaXR5OiAwLjUsXG4gICAgICAgIHdpZHRoOiA1XG4gICAgfTtcbiAgICBsZXQgb2JqZWN0c1NldHRpbmdzID0ge307XG4gICAgbGV0IGluaXRpYWxMb2FkID0gZmFsc2U7XG5cbiAgICBsZXQgbWFwID0gbmV3IEwubWFwKCdtYXBNYWluJywge1xuICAgICAgICB1cGRhdGVXaGVuWm9vbWluZzogZmFsc2UsXG4gICAgICAgIGF0dHJpYnV0aW9uQ29udHJvbDogZmFsc2VcbiAgICB9KTtcblxuICAgIGxldCBtYXBTdHlsZSA9IEwudGlsZUxheWVyKG1hcEJveFVybCwge1xuICAgICAgICBhdHRyaWJ1dGlvbjogbWFwQm94QXR0cmlidXRpb24sXG4gICAgICAgIG1heE5hdGl2ZVpvb206IDE5LFxuICAgICAgICBtYXhab29tOiAyMSxcbiAgICAgICAgbWluWm9vbTogMTEsXG4gICAgICAgIHVwZGF0ZVdoZW5ab29taW5nOiBmYWxzZVxuICAgIH0pO1xuICAgIG1hcFN0eWxlLmFkZFRvKG1hcCk7XG5cbiAgICBsZXQgbXlMb2NhdGlvbkJ1dHRvbiA9IEwuQ29udHJvbC5leHRlbmQoe1xuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICBwb3NpdGlvbjogJ3RvcGxlZnQnXG4gICAgICAgIH0sXG4gICAgICAgIG9uQWRkOiAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgY29udGFpbmVyID0gTC5Eb21VdGlsLmNyZWF0ZSgnYnV0dG9uJywgJ2xlYWZsZXQtYmFyIGxlYWZsZXQtY29udHJvbC1jdXN0b20gZmFyIGZhLWRvdC1jaXJjbGUnKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci50eXBlID0gXCJidXR0b25cIjtcbiAgICAgICAgICAgIGNvbnRhaW5lci5vbmNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxvY2F0ZSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBjb250YWluZXI7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBtYXAuYWRkQ29udHJvbChuZXcgbXlMb2NhdGlvbkJ1dHRvbigpKTtcblxuICAgIGxldCBteUxvY2F0aW9uTGF5ZXJHcm91cCA9IEwubGF5ZXJHcm91cCgpO1xuICAgIG15TG9jYXRpb25MYXllckdyb3VwLmFkZFRvKG1hcCk7XG5cbiAgICBsZXQgcG9wdXNMYXllckdyb3VwID0gTC5sYXllckdyb3VwKCk7XG4gICAgcG9wdXNMYXllckdyb3VwLmFkZFRvKG1hcCk7XG5cbiAgICBsZXQgdXBkYXRlTWFwVGhyb3R0bGU7XG4gICAgbWFwLm9uKCdkcmFnZW5kIHpvb21lbmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh1cGRhdGVNYXBUaHJvdHRsZSk7XG4gICAgICAgIHVwZGF0ZU1hcFRocm90dGxlID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBsZXQgY2VudGVyID0gbWFwLmdldENlbnRlcigpO1xuXG4gICAgICAgICAgICB1cGRhdGVNYXAoY2VudGVyLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFpbml0aWFsTG9hZCkge1xuICAgICAgICAgICAgICAgICAgICBpbml0aWFsTG9hZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkKCcjbWFwTWFpbicpLmRhdGEoJ2xvY2F0ZS1vbi1sb2FkJykgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSwgMjAwKTtcbiAgICB9KTtcblxuICAgIG1hcC5vbignbG9jYXRpb25mb3VuZCcsIHNldE1hcFZpZXdUb015TG9jYXRpb24pO1xuICAgIG1hcC5vbignbG9jYXRpb25lcnJvcicsIHNldEluaXRpYWxNYXBWaWV3KTtcblxuICAgIGxldCBnZW9Kc29uTGF5ZXIgPSBMLmdlb0pTT04oW10sIHsgXG4gICAgICAgIHN0eWxlOiBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgICAgICAgbGV0IHN0eWxlcyA9IG9iamVjdHNTZXR0aW5ncy5zdHlsZXNbZmVhdHVyZS5wcm9wZXJ0aWVzLl9zMV0gPyB7Li4ub2JqZWN0c1NldHRpbmdzLnN0eWxlc1tmZWF0dXJlLnByb3BlcnRpZXMuX3MxXX0gOiB7Li4uZGVmYXVsdE9iamVjdFN0eWxlfTtcbiAgICAgICAgICAgIHJldHVybiBzdHlsZXM7XG4gICAgICAgIH0sXG4gICAgICAgIG9uRWFjaEZlYXR1cmU6IGZ1bmN0aW9uIChmZWF0dXJlLCBsYXllcikge1xuICAgICAgICAgICAgbGF5ZXIub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChmZWF0dXJlLnByb3BlcnRpZXMuX2JlaGF2aW9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJuYXZpZ2F0aW9uXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICB6b29tVG9MYXllcihsYXllciwgZXYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVuTGF5ZXJQb3B1cChsYXllciwgZXYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgem9vbVRvTGF5ZXIobGF5ZXIsIGV2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbGF5ZXIub24oJ21vdXNlb3ZlcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAobGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLmFjdGl2ZVBvcHVwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG9iamVjdHNTZXR0aW5ncy5zdHlsZXNbZmVhdHVyZS5wcm9wZXJ0aWVzLl9zMl0pIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0TGF5ZXJIb3ZlclN0eWxlKGxheWVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGxheWVyLm9uKCdtb3VzZW91dCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAobGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLmFjdGl2ZVBvcHVwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG9iamVjdHNTZXR0aW5ncy5zdHlsZXNbZmVhdHVyZS5wcm9wZXJ0aWVzLl9zMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0TGF5ZXJEZWZhdWx0U3R5bGUobGF5ZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBwb2ludFRvTGF5ZXI6IGZ1bmN0aW9uIChmZWF0dXJlLCBsYXRsbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBMLmNpcmNsZU1hcmtlcihsYXRsbmcsIG9iamVjdHNTZXR0aW5ncy5zdHlsZXNbZmVhdHVyZS5wcm9wZXJ0aWVzLl9zMV0pO1xuICAgICAgICB9XG4gICAgfSkuYWRkVG8obWFwKTtcblxuICAgIHNldEluaXRpYWxNYXBWaWV3KCk7XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVNYXAoY2VudGVyLCBmbiA9ICgpID0+IHtcbiAgICB9KSB7XG4gICAgICAgIGxldCB6b29tID0gbWFwLmdldFpvb20oKTtcbiAgICAgICAgbGV0IGJvdW5kcyA9IG1hcC5nZXRCb3VuZHMoKTtcbiAgICAgICAgbGV0IHJldHVybmVkVGFyZ2V0ID0ge307XG5cbiAgICAgICAgbGV0IGEgPSB7XG4gICAgICAgICAgICBpbjogYm91bmRzLl9zb3V0aFdlc3QubG5nICsgJywnICtcbiAgICAgICAgICAgIGJvdW5kcy5fbm9ydGhFYXN0LmxhdCArICcsJyArXG4gICAgICAgICAgICBib3VuZHMuX25vcnRoRWFzdC5sbmcgKyAnLCcgK1xuICAgICAgICAgICAgYm91bmRzLl9zb3V0aFdlc3QubGF0ICsgJywnLFxuICAgICAgICAgICAgem9vbTogem9vbSxcbiAgICAgICAgICAgIGM6IGNlbnRlci5sYXQgKyAnLCcgKyBjZW50ZXIubG5nXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgcmV0dXJuZWRUYXJnZXQgPSBPYmplY3QuYXNzaWduKGEsIGIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuZWRUYXJnZXQgPSBhO1xuICAgICAgICB9XG5cbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIGRhdGE6IHJldHVybmVkVGFyZ2V0LFxuICAgICAgICAgICAgdXJsOiBcIi9mcm9udC1lbmQvbWFwP1wiLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgICAgICAgICBvYmplY3RzU2V0dGluZ3MgPSByZXN1bHRzLnNldHRpbmdzO1xuICAgICAgICAgICAgICAgIGdlb0pzb25MYXllci5jbGVhckxheWVycygpO1xuICAgICAgICAgICAgICAgIGdlb0pzb25MYXllci5hZGREYXRhKHJlc3VsdHMub2JqZWN0cyk7XG4gICAgICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2F2ZVZpZXdwb3J0KGNlbnRlcikge1xuICAgICAgICBsZXQgem9vbSA9IG1hcC5nZXRab29tKCk7XG4gICAgICAgIGxldCBhID0ge1xuICAgICAgICAgICAgem9vbTogem9vbSxcbiAgICAgICAgICAgIGM6IGNlbnRlci5sYXQgKyAnLCcgKyBjZW50ZXIubG5nXG4gICAgICAgIH07XG5cbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIGRhdGE6IGEsXG4gICAgICAgICAgICB1cmw6IFwiL21hcC96XCIsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0cykge1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvY2F0ZSgpIHtcbiAgICAgICAgbG9hZGluZy5yZW1vdmVDbGFzcygnZC1ub25lJyk7XG4gICAgICAgIG1hcC5sb2NhdGUoe1xuICAgICAgICAgICAgc2V0VmlldzogdHJ1ZSxcbiAgICAgICAgICAgIG1heFpvb206IG9iamVjdHNTZXR0aW5ncy5kZWZhdWx0X3pvb21cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0TWFwVmlld1RvTXlMb2NhdGlvbihlKSB7XG4gICAgICAgIGxvYWRpbmcuYWRkQ2xhc3MoJ2Qtbm9uZScpO1xuICAgICAgICBsZXQgcmFkaXVzID0gZS5hY2N1cmFjeSAvIDI7XG5cbiAgICAgICAgbXlMb2NhdGlvbkxheWVyR3JvdXAuZWFjaExheWVyKChsYXllcikgPT4ge1xuICAgICAgICAgICAgbXlMb2NhdGlvbkxheWVyR3JvdXAucmVtb3ZlTGF5ZXIobGF5ZXIpO1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgY2VudGVyID0gTC5jaXJjbGUoZS5sYXRsbmcsIHtcbiAgICAgICAgICAgIGNvbG9yOiAnI2ZmZicsXG4gICAgICAgICAgICBmaWxsQ29sb3I6ICcjMkE5M0VFJyxcbiAgICAgICAgICAgIGZpbGxPcGFjaXR5OiAxLFxuICAgICAgICAgICAgd2VpZ2h0OiA0LFxuICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgIHJhZGl1czogNVxuICAgICAgICB9KS5hZGRUbyhteUxvY2F0aW9uTGF5ZXJHcm91cCk7XG5cbiAgICAgICAgTC5jaXJjbGUoZS5sYXRsbmcsIHtcbiAgICAgICAgICAgIHJhZGl1czogZS5hY2N1cmFjeSAvIDIsXG4gICAgICAgICAgICBjb2xvcjogJyMxMzZBRUMnLFxuICAgICAgICAgICAgZmlsbENvbG9yOiAnIzEzNkFFQycsXG4gICAgICAgICAgICBmaWxsT3BhY2l0eTogMC4xNSxcbiAgICAgICAgICAgIHdlaWdodDogMFxuICAgICAgICB9KS5hZGRUbyhteUxvY2F0aW9uTGF5ZXJHcm91cCk7XG5cbiAgICAgICAgY2VudGVyLmJpbmRQb3B1cChcItCd0LDQvNC40YDQsNGC0LUg0YHQtSDQsiDRgNCw0LTQuNGD0YEg0L7RgiBcIiArIHJhZGl1cyArIFwiINC80LXRgtGA0LAg0L7RgiDRgtCw0LfQuCDQu9C+0LrQsNGG0LjRj1wiLCB7XG4gICAgICAgICAgICBvZmZzZXQ6IEwucG9pbnQoMCwgLTEwKVxuICAgICAgICB9KTtcbiAgICAgICAgY2VudGVyLm9wZW5Qb3B1cCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldEluaXRpYWxNYXBWaWV3KCkge1xuICAgICAgICBsb2FkaW5nLmFkZENsYXNzKCdkLW5vbmUnKTtcblxuICAgICAgICBsZXQgem9vbTtcbiAgICAgICAgbGV0IGxhdDtcbiAgICAgICAgbGV0IGxuZztcblxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiBcIi9tYXAvcFwiLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgICAgICAgICB6b29tID0gcmVzdWx0cy56b29tO1xuICAgICAgICAgICAgICAgIGxhdCA9IHJlc3VsdHMubGF0O1xuICAgICAgICAgICAgICAgIGxuZyA9IHJlc3VsdHMubG5nO1xuICAgICAgICAgICAgICAgIHNldFJlYWxJbml0aWFsTWFwVmlldyhsYXQsIGxuZywgem9vbSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0UmVhbEluaXRpYWxNYXBWaWV3KGxhdCwgbG5nLCB6b29tKSB7XG4gICAgICAgIG1hcC5zZXRWaWV3KFtsYXQsIGxuZ10sIHpvb20pXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gem9vbVRvTGF5ZXIobGF5ZXIsIGV2KSB7XG4gICAgICAgIGxldCBjbGlja0Nvb3JkaW5hdGVzID0gbWFwLm1vdXNlRXZlbnRUb0xhdExuZyhldi5vcmlnaW5hbEV2ZW50KTtcbiAgICAgICAgaWYgKGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5fem9vbSAmJiBsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuX3pvb20gIT09IG1hcC5nZXRab29tKCkpIHtcbiAgICAgICAgICAgIG1hcC5zZXRWaWV3KGNsaWNrQ29vcmRpbmF0ZXMsIGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5fem9vbSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtYXAuc2V0VmlldyhjbGlja0Nvb3JkaW5hdGVzKTtcblxuICAgICAgICAgICAgc2F2ZVZpZXdwb3J0KGNsaWNrQ29vcmRpbmF0ZXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb3BlbkxheWVyUG9wdXAobGF5ZXIsIGV2KSB7XG4gICAgICAgIHNldExheWVyQWN0aXZlU3R5bGUobGF5ZXIpO1xuICAgICAgICByZW1vdmVBbGxQb3B1cHMoKTtcbiAgICAgICAgbGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLmFjdGl2ZVBvcHVwID0gdHJ1ZTtcblxuICAgICAgICBsZXQgY29vcmRpbmF0ZXM7XG5cblxuICAgICAgICBpZiAobGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLl9iZWhhdmlvciA9PT0gJ3N1cnZleScpIHtcbiAgICAgICAgICAgIGNvb3JkaW5hdGVzID0gbWFwLm1vdXNlRXZlbnRUb0xhdExuZyhldi5vcmlnaW5hbEV2ZW50KTtcbiAgICAgICAgICAgIGlmIChtYXBPcHRpb24uc3VydmV5ID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgb3BlbkNvbmZpcm1Nb2RhbChsYXllcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb29yZGluYXRlcyA9IGV2LmxhdGxuZztcbiAgICAgICAgfVxuXG5cbiAgICAgICAgbGV0IHBvcHVwTGF5ZXIgPSBMLmNpcmNsZShjb29yZGluYXRlcywge1xuICAgICAgICAgICAgZmlsbE9wYWNpdHk6IDAsXG4gICAgICAgICAgICB3ZWlnaHQ6IDAsXG4gICAgICAgICAgICBvcGFjaXR5OiAwLFxuICAgICAgICAgICAgcmFkaXVzOiAxXG4gICAgICAgIH0pLmFkZFRvKHBvcHVzTGF5ZXJHcm91cCk7XG5cbiAgICAgICAgbGV0IHBvcHVwQ29udGVudCA9IGA8cCBjbGFzcz1cInRleHQtY2VudGVyXCI+PCEtLTxmb3JtIG1ldGhvZD1cInBvc3RcIiBjbGFzcz1cIm0tZm9ybVwiIGFjdGlvbj1cIi9mcm9udC1lbmQvZ2VvLWNvbGxlY3Rpb24vYWRkXCI+PGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwiZ2VvLW9iamVjdFwiIHZhbHVlPVwiJHtsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuaWR9XCI+PGJ1dHRvbiB0eXBlPVwic3VibWl0XCI+JHtsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuaWR9PC9idXR0b24+PC9mb3JtPi0tPiR7bGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLnR5cGV9PGJyIC8+JHtsYXllci5mZWF0dXJlLnByb3BlcnRpZXMubmFtZX08L3A+YDtcblxuICAgICAgICBwb3B1cExheWVyLmJpbmRQb3B1cChwb3B1cENvbnRlbnQsIHtcbiAgICAgICAgICAgIG9mZnNldDogTC5wb2ludCgwLCAtMjApXG4gICAgICAgIH0pLm9uKCdwb3B1cGNsb3NlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uZmlybU1vZGFsLmFkZENsYXNzKCdkLW5vbmUnKTtcbiAgICAgICAgICAgIGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5hY3RpdmVQb3B1cCA9IGZhbHNlO1xuICAgICAgICAgICAgc2V0TGF5ZXJEZWZhdWx0U3R5bGUobGF5ZXIpO1xuICAgICAgICAgICAgcmVtb3ZlQWxsUG9wdXBzKCk7XG4gICAgICAgIH0pLm9wZW5Qb3B1cCgpO1xuXG4gICAgICAgIGxldCBjb2xsZWN0aW9uID0gbWFwT3B0aW9uLmNvbGxlY3Rpb247XG5cbiAgICAgICAgaWYgKHR5cGVvZiBjb2xsZWN0aW9uICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcbiAgICAgICAgICAgICAgICB1cmw6ICcvZnJvbnQtZW5kL2dlby1jb2xsZWN0aW9uL2FkZCcsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAnZ2VvLW9iamVjdCc6IGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5pZCxcbiAgICAgICAgICAgICAgICAgICAgJ2NvbGxlY3Rpb24nOiBjb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZU1hcCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8qXG4gICAgICAgICAgICAgICAgJChcIi5tLWZvcm1cIikuc3VibWl0KGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvcm0gPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gZm9ybS5hdHRyKCdhY3Rpb24nKTtcblxuICAgICAgICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvZnJvbnQtZW5kL2dlby1jb2xsZWN0aW9uL2FkZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2RhdGE6IGZvcm0uc2VyaWFsaXplKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2dlby1vYmplY3QnOiAnY2Q1MzhiZjUtMzIyMC00MjU5LWIyNmQtMzQ4OGQ3MWNhN2Q3J1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVNYXAoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAqL1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9wZW5Db25maXJtTW9kYWwobGF5ZXIpIHtcbiAgICAgICAgbGV0IGRpYWxvZ1RpdGxlID0gb2JqZWN0c1NldHRpbmdzLmRpYWxvZ1tsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuX2R0ZXh0XSB8fCAn0JjRgdC60LDRgtC1INC70Lgg0LTQsCDQvtGG0LXQvdC40YLQtSc7XG4gICAgICAgIGxldCBkaWFsb2dMaW5rID0gJy9nZW8vJyArIGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5pZDtcbiAgICAgICAgY29uZmlybU1vZGFsLnJlbW92ZUNsYXNzKCdkLW5vbmUnKTtcbiAgICAgICAgY29uZmlybU1vZGFsLmZpbmQoJ1tkYXRhLWNvbmZpcm0tdGl0bGVdJykuaHRtbChgJHtkaWFsb2dUaXRsZX0/YCk7XG4gICAgICAgIGNvbmZpcm1Nb2RhbC5maW5kKCdbZGF0YS1jb25maXJtLWxpbmtdJykuYXR0cignaHJlZicsIGRpYWxvZ0xpbmspO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbW92ZUFsbFBvcHVwcygpIHtcbiAgICAgICAgbWFwLmNsb3NlUG9wdXAoKTtcbiAgICAgICAgcG9wdXNMYXllckdyb3VwLmVhY2hMYXllcigobGF5ZXIpID0+IHtcbiAgICAgICAgICAgIHBvcHVzTGF5ZXJHcm91cC5yZW1vdmVMYXllcihsYXllcik7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldExheWVyRGVmYXVsdFN0eWxlKGxheWVyKSB7XG4gICAgICAgIGxheWVyLnNldFN0eWxlKG9iamVjdHNTZXR0aW5ncy5zdHlsZXNbbGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLl9zMV0gfHwgZGVmYXVsdE9iamVjdFN0eWxlKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldExheWVySG92ZXJTdHlsZShsYXllcikge1xuICAgICAgICBsYXllci5zZXRTdHlsZShvYmplY3RzU2V0dGluZ3Muc3R5bGVzW2xheWVyLmZlYXR1cmUucHJvcGVydGllcy5fczJdKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldExheWVyQWN0aXZlU3R5bGUobGF5ZXIpIHtcbiAgICAgICAgc3dpdGNoIChsYXllci5mZWF0dXJlLmdlb21ldHJ5LnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJQb2ludFwiOlxuICAgICAgICAgICAgICAgIGxheWVyLnNldFN0eWxlKG9iamVjdHNTZXR0aW5ncy5zdHlsZXNbJ29uX2RpYWxvZ19wb2ludCddKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJNdWx0aUxpbmVTdHJpbmdcIjpcbiAgICAgICAgICAgICAgICBsYXllci5zZXRTdHlsZShvYmplY3RzU2V0dGluZ3Muc3R5bGVzWydvbl9kaWFsb2dfbGluZSddKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJQb2x5Z29uXCI6XG4gICAgICAgICAgICAgICAgbGF5ZXIuc2V0U3R5bGUob2JqZWN0c1NldHRpbmdzLnN0eWxlc1snb25fZGlhbG9nX3BvbHlnb24nXSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGFzc2V0cy9mcm9udC9qcy9tYXAtbWFpbi5qcyJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWEE7QUFhQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBcENBO0FBQ0E7QUFzQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFOQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFDQTtBQU9BO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFUQTtBQVdBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFXQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///2\n");

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _mapConfig = __webpack_require__(0);\n\n(function () {\n\n    if (!document.getElementById('mapMini')) {\n        return;\n    }\n    var loading = $('.loading');\n    var confirmModal = $('.confirm');\n    $(document).on('click', '[data-confirm-cancel]', function () {\n        removeAllPopups();\n    });\n\n    //const mapCenter = mapOption.center;\n    //const mapZoom = mapOption.zoom;\n\n    var defaultObjectStyle = {\n        color: \"#ff9710\",\n        opacity: 0.5,\n        width: 5\n    };\n    var objectsSettings = {};\n    var initialLoad = false;\n\n    var map = new L.map('mapMini', {\n        updateWhenZooming: false,\n        attributionControl: false\n    });\n\n    var mapStyle = L.tileLayer(_mapConfig.mapBoxUrl, {\n        attribution: _mapConfig.mapBoxAttribution,\n        maxNativeZoom: 19,\n        maxZoom: 21,\n        minZoom: 11,\n        updateWhenZooming: false\n    });\n    mapStyle.addTo(map);\n\n    var myLocationButton = L.Control.extend({\n        options: {\n            position: 'topleft'\n        },\n        onAdd: function onAdd() {\n            var container = L.DomUtil.create('button', 'leaflet-bar leaflet-control-custom far fa-dot-circle');\n            container.type = \"button\";\n            container.onclick = function () {\n                locate();\n            };\n            return container;\n        }\n    });\n    map.addControl(new myLocationButton());\n\n    var myLocationLayerGroup = L.layerGroup();\n    myLocationLayerGroup.addTo(map);\n\n    var popusLayerGroup = L.layerGroup();\n    popusLayerGroup.addTo(map);\n\n    var updateMapThrottle = void 0;\n    map.on('dragend zoomend', function () {\n        clearTimeout(updateMapThrottle);\n        updateMapThrottle = setTimeout(function () {\n            var center = map.getCenter();\n\n            updateMap(center, function () {\n                if (!initialLoad) {\n                    initialLoad = true;\n                    if ($('#mapMini').data('locate-on-load') === true) {\n                        locate();\n                    }\n                }\n            });\n        }, 200);\n    });\n\n    map.on('locationfound', setMapViewToMyLocation);\n    map.on('locationerror', setInitialMapView);\n\n    var geoJsonLayer = L.geoJSON([], {\n        style: function style(feature) {\n            return objectsSettings.styles[feature.properties._s1] ? _extends({}, objectsSettings.styles[feature.properties._s1]) : _extends({}, defaultObjectStyle);\n        },\n        onEachFeature: function onEachFeature(feature, layer) {\n            layer.on('click', function (ev) {\n                switch (feature.properties._behavior) {\n                    case \"navigation\":\n                        zoomToLayer(layer, ev);\n                        break;\n                    default:\n                        openLayerPopup(layer, ev);\n                        zoomToLayer(layer, ev);\n                        break;\n                }\n            });\n            layer.on('mouseover', function () {\n                if (layer.feature.properties.activePopup) {\n                    return;\n                }\n                if (objectsSettings.styles[feature.properties._s2]) {\n                    setLayerHoverStyle(layer);\n                }\n            });\n            layer.on('mouseout', function () {\n                if (layer.feature.properties.activePopup) {\n                    return;\n                }\n                if (objectsSettings.styles[feature.properties._s1]) {\n                    setLayerDefaultStyle(layer);\n                }\n            });\n        },\n        pointToLayer: function pointToLayer(feature, latlng) {\n            return L.circleMarker(latlng, objectsSettings.styles[feature.properties._s1]);\n        }\n    }).addTo(map);\n\n    setInitialMapView();\n    getGeoCollectionsList();\n\n    function updateMap(center) {\n        var fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};\n\n        var zoom = map.getZoom();\n        var bounds = map.getBounds();\n        var returnedTarget = {};\n\n        var a = {\n            in: bounds._southWest.lng + ',' + bounds._northEast.lat + ',' + bounds._northEast.lng + ',' + bounds._southWest.lat + ',',\n            zoom: zoom,\n            c: center.lat + ',' + center.lng,\n            g: mapOption.collection,\n            select: mapOption.geoObject\n        };\n\n        if (typeof b !== 'undefined') {\n            returnedTarget = Object.assign(a, b);\n        } else {\n            returnedTarget = a;\n        }\n\n        $.ajax({\n            data: returnedTarget,\n            url: \"/front-end/map?\",\n            success: function success(results) {\n                objectsSettings = results.settings;\n                geoJsonLayer.clearLayers();\n                geoJsonLayer.addData(results.objects);\n                /*\n                                map.fitBounds(results.bbox, {\n                                 });\n                */\n                fn();\n            }\n        });\n    }\n\n    function saveViewport(center) {\n        var zoom = map.getZoom();\n        var a = {\n            zoom: zoom,\n            c: center.lat + ',' + center.lng\n        };\n\n        $.ajax({\n            data: a,\n            url: \"/map/z\",\n            success: function success() {}\n        });\n    }\n\n    function locate() {\n        loading.removeClass('d-none');\n        map.locate({\n            setView: true,\n            maxZoom: objectsSettings.default_zoom\n        });\n    }\n\n    function setMapViewToMyLocation(e) {\n        loading.addClass('d-none');\n        var radius = e.accuracy / 2;\n\n        myLocationLayerGroup.eachLayer(function (layer) {\n            myLocationLayerGroup.removeLayer(layer);\n        });\n\n        var center = L.circle(e.latlng, {\n            color: '#fff',\n            fillColor: '#2A93EE',\n            fillOpacity: 1,\n            weight: 4,\n            opacity: 1,\n            radius: 5\n        }).addTo(myLocationLayerGroup);\n\n        L.circle(e.latlng, {\n            radius: e.accuracy / 2,\n            color: '#136AEC',\n            fillColor: '#136AEC',\n            fillOpacity: 0.15,\n            weight: 0\n        }).addTo(myLocationLayerGroup);\n\n        center.bindPopup(\"Намирате се в радиус от \" + radius + \" метра от тази локация\", {\n            offset: L.point(0, -10)\n        });\n        center.openPopup();\n    }\n\n    function setInitialMapView() {\n        loading.addClass('d-none');\n\n        var zoom = void 0;\n        var lat = void 0;\n        var lng = void 0;\n\n        if (_typeof(mapOption.bbox) == \"object\") {\n            map.fitBounds(mapOption.bbox, {});\n        } else {\n            $.ajax({\n                url: \"/map/p\",\n                success: function success(results) {\n                    zoom = results.zoom;\n                    lat = results.lat;\n                    lng = results.lng;\n\n                    setRealInitialMapView(lat, lng, zoom);\n                }\n            });\n        }\n    }\n\n    function setRealInitialMapView(lat, lng, zoom) {\n        map.setView([lat, lng], zoom);\n    }\n\n    function zoomToLayer(layer, ev) {\n        var clickCoordinates = map.mouseEventToLatLng(ev.originalEvent);\n        if (layer.feature.properties._zoom && layer.feature.properties._zoom !== map.getZoom()) {\n            map.setView(clickCoordinates, layer.feature.properties._zoom);\n        } else {\n            map.setView(clickCoordinates);\n\n            saveViewport(clickCoordinates);\n        }\n    }\n\n    function openLayerPopup(layer, ev) {\n        setLayerActiveStyle(layer);\n        removeAllPopups();\n        layer.feature.properties.activePopup = true;\n\n        var coordinates = void 0;\n\n        if (layer.feature.properties._behavior === 'survey') {\n            coordinates = map.mouseEventToLatLng(ev.originalEvent);\n            if (mapOption.survey === true) {\n                openConfirmModal(layer);\n            }\n        } else {\n            coordinates = ev.latlng;\n        }\n\n        var popupLayer = L.circle(coordinates, {\n            fillOpacity: 0,\n            weight: 0,\n            opacity: 0,\n            radius: 1\n        }).addTo(popusLayerGroup);\n\n        var popupContent = '<p class=\"text-center\"><!--<form method=\"post\" class=\"m-form\" action=\"/front-end/geo-collection/add\"><input type=\"hidden\" name=\"geo-object\" value=\"' + layer.feature.properties.id + '\"><button type=\"submit\">' + layer.feature.properties.id + '</button></form>-->' + layer.feature.properties.type + '<br />' + layer.feature.properties.name + '</p>';\n\n        popupLayer.bindPopup(popupContent, {\n            offset: L.point(0, -20)\n        }).on('popupclose', function () {\n            confirmModal.addClass('d-none');\n            layer.feature.properties.activePopup = false;\n            setLayerDefaultStyle(layer);\n            removeAllPopups();\n        }).openPopup();\n\n        var collection = mapOption.collection;\n\n        if (typeof collection !== 'undefined') {\n            $.ajax({\n                type: \"POST\",\n                url: '/front-end/geo-collection/add',\n                data: {\n                    'geo-object': layer.feature.properties.id,\n                    'collection': collection\n                },\n                success: function success() {\n                    var center = map.getCenter();\n                    updateMap(center);\n                    getGeoCollectionsList();\n                }\n            });\n\n            // TODO: Reduce getGeoCollectionsList call\n            getGeoCollectionsList();\n        }\n\n        /*\n                $(\".m-form\").submit(function(e) {\n                    var form = $(this);\n                    var url = form.attr('action');\n                     $.ajax({\n                        type: \"POST\",\n                        url: '/front-end/geo-collection/add',\n                        //data: form.serialize(),\n                        data: {\n                            'geo-object': 'cd538bf5-3220-4259-b26d-3488d71ca7d7'\n                        },\n                        success: function()\n                        {\n                            updateMap();\n                        }\n                    });\n                     e.preventDefault();\n                });\n        */\n    }\n\n    function getGeoCollectionsList() {\n        $.ajax({\n            url: \"/geo-collection/info\",\n            success: function success(result) {\n                var html = '<ul class=\"mt-4 pl-4\">';\n\n                Object.keys(result).forEach(function (item) {\n                    html += '<li class=\"mb-2\">\\n\\t\\t\\t\\t\\t\\t\\t<a href=\"/geo-collection/' + result[item].collectionUuid + '\" class=\"font-weight-bold\">\\u041C\\u0430\\u0440\\u0448\\u0440\\u0443\\u0442</a>';\n                    if (typeof gcOpen !== 'undefined') {\n                        if (gcOpen === result[item].collectionUuid) {\n                            html += ' [<span class=\"text-success\">\\u0430\\u043A\\u0442\\u0438\\u0432\\u0435\\u043D</span>]\\n\\t\\t\\t\\t\\t\\t\\t<form method=\"post\" class=\"float-right\">\\n\\t\\t\\t\\t\\t\\t\\t    <input type=\"hidden\" name=\"_method\" value=\"delete\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<button type=\"submit\" class=\"btn btn-sm btn-danger\" style=\"font-size: 11px; padding: 4px 5px 0\"><i class=\"fa fa-trash\"></i> </button>\\n\\t\\t\\t\\t\\t\\t\\t</form>';\n                        }\n                    }\n\n                    html += '<div>\\n\\t\\t\\t\\t\\t\\t\\t\\u0434\\u044A\\u043B\\u0436\\u0438\\u043D\\u0430: ' + result[item].length + ' \\u043C<br />\\n\\t\\t\\t\\t\\t\\t\\t\\u043E\\u0446\\u0435\\u043D\\u0435\\u043D: ' + result[item].completion.percentage + ' %<br />\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\"progress\" style=\"height: 3px;\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\"progress-bar\" role=\"progressbar\" style=\"width: ' + result[item].completion.percentage + '%;\" aria-valuenow=\"25\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>';\n\n                    if (result[item].interconnectedClustersCount > 1) {\n                        html += '<span class=\"text-danger\">\\u0433\\u0440\\u0435\\u0448\\u043A\\u0430: \\u0432 \\u043C\\u0430\\u0440\\u0448\\u0440\\u0443\\u0442\\u0430 \\u0438\\u043C\\u0430 \\u043F\\u0440\\u0435\\u043A\\u044A\\u0441\\u0432\\u0430\\u043D\\u0435</span>';\n                    }\n\n                    html += '</div>\\n\\t\\t\\t\\t\\t\\t</li>';\n                });\n\n                html += '</ul>';\n\n                $(\"#div3\").html(html);\n            }\n        });\n    }\n\n    function openConfirmModal(layer) {\n        var dialogTitle = objectsSettings.dialog[layer.feature.properties._dtext] || 'Искате ли да оцените';\n        var dialogLink = '/geo/' + layer.feature.properties.id;\n        confirmModal.removeClass('d-none');\n        confirmModal.find('[data-confirm-title]').html(dialogTitle + '?');\n        confirmModal.find('[data-confirm-link]').attr('href', dialogLink);\n    }\n\n    function removeAllPopups() {\n        map.closePopup();\n        popusLayerGroup.eachLayer(function (layer) {\n            popusLayerGroup.removeLayer(layer);\n        });\n    }\n\n    function setLayerDefaultStyle(layer) {\n        layer.setStyle(objectsSettings.styles[layer.feature.properties._s1] || defaultObjectStyle);\n    }\n\n    function setLayerHoverStyle(layer) {\n        layer.setStyle(objectsSettings.styles[layer.feature.properties._s2]);\n    }\n\n    function setLayerActiveStyle(layer) {\n        switch (layer.feature.geometry.type) {\n            case \"Point\":\n                layer.setStyle(objectsSettings.styles['on_dialog_point']);\n                break;\n            case \"MultiLineString\":\n                layer.setStyle(objectsSettings.styles['on_dialog_line']);\n                break;\n            case \"Polygon\":\n                layer.setStyle(objectsSettings.styles['on_dialog_polygon']);\n                break;\n        }\n    }\n})();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hc3NldHMvZnJvbnQvanMvbWFwLW1pbmkuanM/ZTE1ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge21hcEJveEF0dHJpYnV0aW9uLCBtYXBCb3hVcmx9IGZyb20gJy4vbWFwLWNvbmZpZyc7XG5cbigoKSA9PiB7XG5cbiAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXBNaW5pJykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBsb2FkaW5nID0gJCgnLmxvYWRpbmcnKTtcbiAgICBjb25zdCBjb25maXJtTW9kYWwgPSAkKCcuY29uZmlybScpO1xuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdbZGF0YS1jb25maXJtLWNhbmNlbF0nLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJlbW92ZUFsbFBvcHVwcygpO1xuICAgIH0pO1xuXG4gICAgLy9jb25zdCBtYXBDZW50ZXIgPSBtYXBPcHRpb24uY2VudGVyO1xuICAgIC8vY29uc3QgbWFwWm9vbSA9IG1hcE9wdGlvbi56b29tO1xuXG4gICAgY29uc3QgZGVmYXVsdE9iamVjdFN0eWxlID0ge1xuICAgICAgICBjb2xvcjogXCIjZmY5NzEwXCIsXG4gICAgICAgIG9wYWNpdHk6IDAuNSxcbiAgICAgICAgd2lkdGg6IDVcbiAgICB9O1xuICAgIGxldCBvYmplY3RzU2V0dGluZ3MgPSB7fTtcbiAgICBsZXQgaW5pdGlhbExvYWQgPSBmYWxzZTtcblxuICAgIGxldCBtYXAgPSBuZXcgTC5tYXAoJ21hcE1pbmknLCB7XG4gICAgICAgIHVwZGF0ZVdoZW5ab29taW5nOiBmYWxzZSxcbiAgICAgICAgYXR0cmlidXRpb25Db250cm9sOiBmYWxzZVxuICAgIH0pO1xuXG4gICAgbGV0IG1hcFN0eWxlID0gTC50aWxlTGF5ZXIobWFwQm94VXJsLCB7XG4gICAgICAgIGF0dHJpYnV0aW9uOiBtYXBCb3hBdHRyaWJ1dGlvbixcbiAgICAgICAgbWF4TmF0aXZlWm9vbTogMTksXG4gICAgICAgIG1heFpvb206IDIxLFxuICAgICAgICBtaW5ab29tOiAxMSxcbiAgICAgICAgdXBkYXRlV2hlblpvb21pbmc6IGZhbHNlXG4gICAgfSk7XG4gICAgbWFwU3R5bGUuYWRkVG8obWFwKTtcblxuICAgIGxldCBteUxvY2F0aW9uQnV0dG9uID0gTC5Db250cm9sLmV4dGVuZCh7XG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wbGVmdCdcbiAgICAgICAgfSxcbiAgICAgICAgb25BZGQ6ICgpID0+IHtcbiAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBMLkRvbVV0aWwuY3JlYXRlKCdidXR0b24nLCAnbGVhZmxldC1iYXIgbGVhZmxldC1jb250cm9sLWN1c3RvbSBmYXIgZmEtZG90LWNpcmNsZScpO1xuICAgICAgICAgICAgY29udGFpbmVyLnR5cGUgPSBcImJ1dHRvblwiO1xuICAgICAgICAgICAgY29udGFpbmVyLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbG9jYXRlKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRhaW5lcjtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIG1hcC5hZGRDb250cm9sKG5ldyBteUxvY2F0aW9uQnV0dG9uKCkpO1xuXG4gICAgbGV0IG15TG9jYXRpb25MYXllckdyb3VwID0gTC5sYXllckdyb3VwKCk7XG4gICAgbXlMb2NhdGlvbkxheWVyR3JvdXAuYWRkVG8obWFwKTtcblxuICAgIGxldCBwb3B1c0xheWVyR3JvdXAgPSBMLmxheWVyR3JvdXAoKTtcbiAgICBwb3B1c0xheWVyR3JvdXAuYWRkVG8obWFwKTtcblxuICAgIGxldCB1cGRhdGVNYXBUaHJvdHRsZTtcbiAgICBtYXAub24oJ2RyYWdlbmQgem9vbWVuZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHVwZGF0ZU1hcFRocm90dGxlKTtcbiAgICAgICAgdXBkYXRlTWFwVGhyb3R0bGUgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGxldCBjZW50ZXIgPSBtYXAuZ2V0Q2VudGVyKCk7XG5cbiAgICAgICAgICAgIHVwZGF0ZU1hcChjZW50ZXIsICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWluaXRpYWxMb2FkKSB7XG4gICAgICAgICAgICAgICAgICAgIGluaXRpYWxMb2FkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQoJyNtYXBNaW5pJykuZGF0YSgnbG9jYXRlLW9uLWxvYWQnKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9LCAyMDApO1xuICAgIH0pO1xuXG4gICAgbWFwLm9uKCdsb2NhdGlvbmZvdW5kJywgc2V0TWFwVmlld1RvTXlMb2NhdGlvbik7XG4gICAgbWFwLm9uKCdsb2NhdGlvbmVycm9yJywgc2V0SW5pdGlhbE1hcFZpZXcpO1xuXG4gICAgbGV0IGdlb0pzb25MYXllciA9IEwuZ2VvSlNPTihbXSwge1xuICAgICAgICBzdHlsZTogZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgICAgICAgICAgIHJldHVybiBvYmplY3RzU2V0dGluZ3Muc3R5bGVzW2ZlYXR1cmUucHJvcGVydGllcy5fczFdID8gey4uLm9iamVjdHNTZXR0aW5ncy5zdHlsZXNbZmVhdHVyZS5wcm9wZXJ0aWVzLl9zMV19IDogey4uLmRlZmF1bHRPYmplY3RTdHlsZX1cbiAgICAgICAgfSxcbiAgICAgICAgb25FYWNoRmVhdHVyZTogZnVuY3Rpb24gKGZlYXR1cmUsIGxheWVyKSB7XG4gICAgICAgICAgICBsYXllci5vbignY2xpY2snLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGZlYXR1cmUucHJvcGVydGllcy5fYmVoYXZpb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm5hdmlnYXRpb25cIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHpvb21Ub0xheWVyKGxheWVyLCBldik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5MYXllclBvcHVwKGxheWVyLCBldik7XG4gICAgICAgICAgICAgICAgICAgICAgICB6b29tVG9MYXllcihsYXllciwgZXYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBsYXllci5vbignbW91c2VvdmVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuYWN0aXZlUG9wdXApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAob2JqZWN0c1NldHRpbmdzLnN0eWxlc1tmZWF0dXJlLnByb3BlcnRpZXMuX3MyXSkge1xuICAgICAgICAgICAgICAgICAgICBzZXRMYXllckhvdmVyU3R5bGUobGF5ZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbGF5ZXIub24oJ21vdXNlb3V0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuYWN0aXZlUG9wdXApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAob2JqZWN0c1NldHRpbmdzLnN0eWxlc1tmZWF0dXJlLnByb3BlcnRpZXMuX3MxXSkge1xuICAgICAgICAgICAgICAgICAgICBzZXRMYXllckRlZmF1bHRTdHlsZShsYXllcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIHBvaW50VG9MYXllcjogZnVuY3Rpb24gKGZlYXR1cmUsIGxhdGxuZykge1xuICAgICAgICAgICAgcmV0dXJuIEwuY2lyY2xlTWFya2VyKGxhdGxuZywgb2JqZWN0c1NldHRpbmdzLnN0eWxlc1tmZWF0dXJlLnByb3BlcnRpZXMuX3MxXSk7XG4gICAgICAgIH1cbiAgICB9KS5hZGRUbyhtYXApO1xuXG4gICAgc2V0SW5pdGlhbE1hcFZpZXcoKTtcbiAgICBnZXRHZW9Db2xsZWN0aW9uc0xpc3QoKTtcblxuXG4gICAgZnVuY3Rpb24gdXBkYXRlTWFwKGNlbnRlciwgZm4gPSAoKSA9PiB7XG4gICAgfSkge1xuICAgICAgICBsZXQgem9vbSA9IG1hcC5nZXRab29tKCk7XG4gICAgICAgIGxldCBib3VuZHMgPSBtYXAuZ2V0Qm91bmRzKCk7XG4gICAgICAgIGxldCByZXR1cm5lZFRhcmdldCA9IHt9O1xuXG4gICAgICAgIGxldCBhID0ge1xuICAgICAgICAgICAgaW46IGJvdW5kcy5fc291dGhXZXN0LmxuZyArICcsJyArXG4gICAgICAgICAgICAgICAgYm91bmRzLl9ub3J0aEVhc3QubGF0ICsgJywnICtcbiAgICAgICAgICAgICAgICBib3VuZHMuX25vcnRoRWFzdC5sbmcgKyAnLCcgK1xuICAgICAgICAgICAgICAgIGJvdW5kcy5fc291dGhXZXN0LmxhdCArICcsJyxcbiAgICAgICAgICAgIHpvb206IHpvb20sXG4gICAgICAgICAgICBjOiBjZW50ZXIubGF0ICsgJywnICsgY2VudGVyLmxuZyxcbiAgICAgICAgICAgIGc6IG1hcE9wdGlvbi5jb2xsZWN0aW9uLFxuICAgICAgICAgICAgc2VsZWN0OiBtYXBPcHRpb24uZ2VvT2JqZWN0XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgcmV0dXJuZWRUYXJnZXQgPSBPYmplY3QuYXNzaWduKGEsIGIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuZWRUYXJnZXQgPSBhO1xuICAgICAgICB9XG5cbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIGRhdGE6IHJldHVybmVkVGFyZ2V0LFxuICAgICAgICAgICAgdXJsOiBcIi9mcm9udC1lbmQvbWFwP1wiLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgICAgICAgICBvYmplY3RzU2V0dGluZ3MgPSByZXN1bHRzLnNldHRpbmdzO1xuICAgICAgICAgICAgICAgIGdlb0pzb25MYXllci5jbGVhckxheWVycygpO1xuICAgICAgICAgICAgICAgIGdlb0pzb25MYXllci5hZGREYXRhKHJlc3VsdHMub2JqZWN0cyk7XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwLmZpdEJvdW5kcyhyZXN1bHRzLmJib3gsIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNhdmVWaWV3cG9ydChjZW50ZXIpIHtcbiAgICAgICAgbGV0IHpvb20gPSBtYXAuZ2V0Wm9vbSgpO1xuICAgICAgICBsZXQgYSA9IHtcbiAgICAgICAgICAgIHpvb206IHpvb20sXG4gICAgICAgICAgICBjOiBjZW50ZXIubGF0ICsgJywnICsgY2VudGVyLmxuZ1xuICAgICAgICB9O1xuXG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICBkYXRhOiBhLFxuICAgICAgICAgICAgdXJsOiBcIi9tYXAvelwiLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKCkge1xuXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9jYXRlKCkge1xuICAgICAgICBsb2FkaW5nLnJlbW92ZUNsYXNzKCdkLW5vbmUnKTtcbiAgICAgICAgbWFwLmxvY2F0ZSh7XG4gICAgICAgICAgICBzZXRWaWV3OiB0cnVlLFxuICAgICAgICAgICAgbWF4Wm9vbTogb2JqZWN0c1NldHRpbmdzLmRlZmF1bHRfem9vbVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRNYXBWaWV3VG9NeUxvY2F0aW9uKGUpIHtcbiAgICAgICAgbG9hZGluZy5hZGRDbGFzcygnZC1ub25lJyk7XG4gICAgICAgIGxldCByYWRpdXMgPSBlLmFjY3VyYWN5IC8gMjtcblxuICAgICAgICBteUxvY2F0aW9uTGF5ZXJHcm91cC5lYWNoTGF5ZXIoKGxheWVyKSA9PiB7XG4gICAgICAgICAgICBteUxvY2F0aW9uTGF5ZXJHcm91cC5yZW1vdmVMYXllcihsYXllcik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCBjZW50ZXIgPSBMLmNpcmNsZShlLmxhdGxuZywge1xuICAgICAgICAgICAgY29sb3I6ICcjZmZmJyxcbiAgICAgICAgICAgIGZpbGxDb2xvcjogJyMyQTkzRUUnLFxuICAgICAgICAgICAgZmlsbE9wYWNpdHk6IDEsXG4gICAgICAgICAgICB3ZWlnaHQ6IDQsXG4gICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgcmFkaXVzOiA1XG4gICAgICAgIH0pLmFkZFRvKG15TG9jYXRpb25MYXllckdyb3VwKTtcblxuICAgICAgICBMLmNpcmNsZShlLmxhdGxuZywge1xuICAgICAgICAgICAgcmFkaXVzOiBlLmFjY3VyYWN5IC8gMixcbiAgICAgICAgICAgIGNvbG9yOiAnIzEzNkFFQycsXG4gICAgICAgICAgICBmaWxsQ29sb3I6ICcjMTM2QUVDJyxcbiAgICAgICAgICAgIGZpbGxPcGFjaXR5OiAwLjE1LFxuICAgICAgICAgICAgd2VpZ2h0OiAwXG4gICAgICAgIH0pLmFkZFRvKG15TG9jYXRpb25MYXllckdyb3VwKTtcblxuICAgICAgICBjZW50ZXIuYmluZFBvcHVwKFwi0J3QsNC80LjRgNCw0YLQtSDRgdC1INCyINGA0LDQtNC40YPRgSDQvtGCIFwiICsgcmFkaXVzICsgXCIg0LzQtdGC0YDQsCDQvtGCINGC0LDQt9C4INC70L7QutCw0YbQuNGPXCIsIHtcbiAgICAgICAgICAgIG9mZnNldDogTC5wb2ludCgwLCAtMTApXG4gICAgICAgIH0pO1xuICAgICAgICBjZW50ZXIub3BlblBvcHVwKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0SW5pdGlhbE1hcFZpZXcoKSB7XG4gICAgICAgIGxvYWRpbmcuYWRkQ2xhc3MoJ2Qtbm9uZScpO1xuXG4gICAgICAgIGxldCB6b29tO1xuICAgICAgICBsZXQgbGF0O1xuICAgICAgICBsZXQgbG5nO1xuXG4gICAgICAgIGlmICh0eXBlb2YgbWFwT3B0aW9uLmJib3ggPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgbWFwLmZpdEJvdW5kcyhtYXBPcHRpb24uYmJveCwge30pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICB1cmw6IFwiL21hcC9wXCIsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgem9vbSA9IHJlc3VsdHMuem9vbTtcbiAgICAgICAgICAgICAgICAgICAgbGF0ID0gcmVzdWx0cy5sYXQ7XG4gICAgICAgICAgICAgICAgICAgIGxuZyA9IHJlc3VsdHMubG5nO1xuXG4gICAgICAgICAgICAgICAgICAgIHNldFJlYWxJbml0aWFsTWFwVmlldyhsYXQsIGxuZywgem9vbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRSZWFsSW5pdGlhbE1hcFZpZXcobGF0LCBsbmcsIHpvb20pIHtcbiAgICAgICAgbWFwLnNldFZpZXcoW2xhdCwgbG5nXSwgem9vbSlcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB6b29tVG9MYXllcihsYXllciwgZXYpIHtcbiAgICAgICAgbGV0IGNsaWNrQ29vcmRpbmF0ZXMgPSBtYXAubW91c2VFdmVudFRvTGF0TG5nKGV2Lm9yaWdpbmFsRXZlbnQpO1xuICAgICAgICBpZiAobGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLl96b29tICYmIGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5fem9vbSAhPT0gbWFwLmdldFpvb20oKSkge1xuICAgICAgICAgICAgbWFwLnNldFZpZXcoY2xpY2tDb29yZGluYXRlcywgbGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLl96b29tKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1hcC5zZXRWaWV3KGNsaWNrQ29vcmRpbmF0ZXMpO1xuXG4gICAgICAgICAgICBzYXZlVmlld3BvcnQoY2xpY2tDb29yZGluYXRlcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvcGVuTGF5ZXJQb3B1cChsYXllciwgZXYpIHtcbiAgICAgICAgc2V0TGF5ZXJBY3RpdmVTdHlsZShsYXllcik7XG4gICAgICAgIHJlbW92ZUFsbFBvcHVwcygpO1xuICAgICAgICBsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuYWN0aXZlUG9wdXAgPSB0cnVlO1xuXG4gICAgICAgIGxldCBjb29yZGluYXRlcztcblxuXG4gICAgICAgIGlmIChsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuX2JlaGF2aW9yID09PSAnc3VydmV5Jykge1xuICAgICAgICAgICAgY29vcmRpbmF0ZXMgPSBtYXAubW91c2VFdmVudFRvTGF0TG5nKGV2Lm9yaWdpbmFsRXZlbnQpO1xuICAgICAgICAgICAgaWYgKG1hcE9wdGlvbi5zdXJ2ZXkgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBvcGVuQ29uZmlybU1vZGFsKGxheWVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvb3JkaW5hdGVzID0gZXYubGF0bG5nO1xuICAgICAgICB9XG5cblxuICAgICAgICBsZXQgcG9wdXBMYXllciA9IEwuY2lyY2xlKGNvb3JkaW5hdGVzLCB7XG4gICAgICAgICAgICBmaWxsT3BhY2l0eTogMCxcbiAgICAgICAgICAgIHdlaWdodDogMCxcbiAgICAgICAgICAgIG9wYWNpdHk6IDAsXG4gICAgICAgICAgICByYWRpdXM6IDFcbiAgICAgICAgfSkuYWRkVG8ocG9wdXNMYXllckdyb3VwKTtcblxuICAgICAgICBsZXQgcG9wdXBDb250ZW50ID0gYDxwIGNsYXNzPVwidGV4dC1jZW50ZXJcIj48IS0tPGZvcm0gbWV0aG9kPVwicG9zdFwiIGNsYXNzPVwibS1mb3JtXCIgYWN0aW9uPVwiL2Zyb250LWVuZC9nZW8tY29sbGVjdGlvbi9hZGRcIj48aW5wdXQgdHlwZT1cImhpZGRlblwiIG5hbWU9XCJnZW8tb2JqZWN0XCIgdmFsdWU9XCIke2xheWVyLmZlYXR1cmUucHJvcGVydGllcy5pZH1cIj48YnV0dG9uIHR5cGU9XCJzdWJtaXRcIj4ke2xheWVyLmZlYXR1cmUucHJvcGVydGllcy5pZH08L2J1dHRvbj48L2Zvcm0+LS0+JHtsYXllci5mZWF0dXJlLnByb3BlcnRpZXMudHlwZX08YnIgLz4ke2xheWVyLmZlYXR1cmUucHJvcGVydGllcy5uYW1lfTwvcD5gO1xuXG4gICAgICAgIHBvcHVwTGF5ZXIuYmluZFBvcHVwKHBvcHVwQ29udGVudCwge1xuICAgICAgICAgICAgb2Zmc2V0OiBMLnBvaW50KDAsIC0yMClcbiAgICAgICAgfSkub24oJ3BvcHVwY2xvc2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb25maXJtTW9kYWwuYWRkQ2xhc3MoJ2Qtbm9uZScpO1xuICAgICAgICAgICAgbGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLmFjdGl2ZVBvcHVwID0gZmFsc2U7XG4gICAgICAgICAgICBzZXRMYXllckRlZmF1bHRTdHlsZShsYXllcik7XG4gICAgICAgICAgICByZW1vdmVBbGxQb3B1cHMoKTtcbiAgICAgICAgfSkub3BlblBvcHVwKCk7XG5cbiAgICAgICAgbGV0IGNvbGxlY3Rpb24gPSBtYXBPcHRpb24uY29sbGVjdGlvbjtcblxuICAgICAgICBpZiAodHlwZW9mIGNvbGxlY3Rpb24gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxuICAgICAgICAgICAgICAgIHVybDogJy9mcm9udC1lbmQvZ2VvLWNvbGxlY3Rpb24vYWRkJyxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICdnZW8tb2JqZWN0JzogbGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLmlkLFxuICAgICAgICAgICAgICAgICAgICAnY29sbGVjdGlvbic6IGNvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNlbnRlciA9IG1hcC5nZXRDZW50ZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlTWFwKGNlbnRlcik7XG4gICAgICAgICAgICAgICAgICAgIGdldEdlb0NvbGxlY3Rpb25zTGlzdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBUT0RPOiBSZWR1Y2UgZ2V0R2VvQ29sbGVjdGlvbnNMaXN0IGNhbGxcbiAgICAgICAgICAgIGdldEdlb0NvbGxlY3Rpb25zTGlzdCgpO1xuICAgICAgICB9XG5cblxuICAgICAgICAvKlxuICAgICAgICAgICAgICAgICQoXCIubS1mb3JtXCIpLnN1Ym1pdChmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmb3JtID0gJCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IGZvcm0uYXR0cignYWN0aW9uJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2Zyb250LWVuZC9nZW8tY29sbGVjdGlvbi9hZGQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy9kYXRhOiBmb3JtLnNlcmlhbGl6ZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdnZW8tb2JqZWN0JzogJ2NkNTM4YmY1LTMyMjAtNDI1OS1iMjZkLTM0ODhkNzFjYTdkNydcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlTWFwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgKi9cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRHZW9Db2xsZWN0aW9uc0xpc3QoKSB7XG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB1cmw6IFwiL2dlby1jb2xsZWN0aW9uL2luZm9cIixcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBsZXQgaHRtbCA9IGA8dWwgY2xhc3M9XCJtdC00IHBsLTRcIj5gO1xuXG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMocmVzdWx0KS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gYDxsaSBjbGFzcz1cIm1iLTJcIj5cblx0XHRcdFx0XHRcdFx0PGEgaHJlZj1cIi9nZW8tY29sbGVjdGlvbi8ke3Jlc3VsdFtpdGVtXS5jb2xsZWN0aW9uVXVpZH1cIiBjbGFzcz1cImZvbnQtd2VpZ2h0LWJvbGRcIj7QnNCw0YDRiNGA0YPRgjwvYT5gO1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGdjT3BlbiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnY09wZW4gPT09IHJlc3VsdFtpdGVtXS5jb2xsZWN0aW9uVXVpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gYCBbPHNwYW4gY2xhc3M9XCJ0ZXh0LXN1Y2Nlc3NcIj7QsNC60YLQuNCy0LXQvTwvc3Bhbj5dXG5cdFx0XHRcdFx0XHRcdDxmb3JtIG1ldGhvZD1cInBvc3RcIiBjbGFzcz1cImZsb2F0LXJpZ2h0XCI+XG5cdFx0XHRcdFx0XHRcdCAgICA8aW5wdXQgdHlwZT1cImhpZGRlblwiIG5hbWU9XCJfbWV0aG9kXCIgdmFsdWU9XCJkZWxldGVcIj5cblx0XHRcdFx0XHRcdFx0XHQ8YnV0dG9uIHR5cGU9XCJzdWJtaXRcIiBjbGFzcz1cImJ0biBidG4tc20gYnRuLWRhbmdlclwiIHN0eWxlPVwiZm9udC1zaXplOiAxMXB4OyBwYWRkaW5nOiA0cHggNXB4IDBcIj48aSBjbGFzcz1cImZhIGZhLXRyYXNoXCI+PC9pPiA8L2J1dHRvbj5cblx0XHRcdFx0XHRcdFx0PC9mb3JtPmA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gYDxkaXY+XG5cdFx0XHRcdFx0XHRcdNC00YrQu9C20LjQvdCwOiAke3Jlc3VsdFtpdGVtXS5sZW5ndGh9INC8PGJyIC8+XG5cdFx0XHRcdFx0XHRcdNC+0YbQtdC90LXQvTogJHtyZXN1bHRbaXRlbV0uY29tcGxldGlvbi5wZXJjZW50YWdlfSAlPGJyIC8+XG5cdFx0XHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cInByb2dyZXNzXCIgc3R5bGU9XCJoZWlnaHQ6IDNweDtcIj5cblx0XHRcdFx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJwcm9ncmVzcy1iYXJcIiByb2xlPVwicHJvZ3Jlc3NiYXJcIiBzdHlsZT1cIndpZHRoOiAke3Jlc3VsdFtpdGVtXS5jb21wbGV0aW9uLnBlcmNlbnRhZ2V9JTtcIiBhcmlhLXZhbHVlbm93PVwiMjVcIiBhcmlhLXZhbHVlbWluPVwiMFwiIGFyaWEtdmFsdWVtYXg9XCIxMDBcIj48L2Rpdj5cblx0XHRcdFx0XHRcdFx0XHQ8L2Rpdj5gO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKHJlc3VsdFtpdGVtXS5pbnRlcmNvbm5lY3RlZENsdXN0ZXJzQ291bnQgPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IGA8c3BhbiBjbGFzcz1cInRleHQtZGFuZ2VyXCI+0LPRgNC10YjQutCwOiDQsiDQvNCw0YDRiNGA0YPRgtCwINC40LzQsCDQv9GA0LXQutGK0YHQstCw0L3QtTwvc3Bhbj5gO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPVx0YDwvZGl2PlxuXHRcdFx0XHRcdFx0PC9saT5gO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaHRtbCArPSBgPC91bD5gO1xuXG4gICAgICAgICAgICAgICAgJChcIiNkaXYzXCIpLmh0bWwoaHRtbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9wZW5Db25maXJtTW9kYWwobGF5ZXIpIHtcbiAgICAgICAgbGV0IGRpYWxvZ1RpdGxlID0gb2JqZWN0c1NldHRpbmdzLmRpYWxvZ1tsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuX2R0ZXh0XSB8fCAn0JjRgdC60LDRgtC1INC70Lgg0LTQsCDQvtGG0LXQvdC40YLQtSc7XG4gICAgICAgIGxldCBkaWFsb2dMaW5rID0gJy9nZW8vJyArIGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5pZDtcbiAgICAgICAgY29uZmlybU1vZGFsLnJlbW92ZUNsYXNzKCdkLW5vbmUnKTtcbiAgICAgICAgY29uZmlybU1vZGFsLmZpbmQoJ1tkYXRhLWNvbmZpcm0tdGl0bGVdJykuaHRtbChgJHtkaWFsb2dUaXRsZX0/YCk7XG4gICAgICAgIGNvbmZpcm1Nb2RhbC5maW5kKCdbZGF0YS1jb25maXJtLWxpbmtdJykuYXR0cignaHJlZicsIGRpYWxvZ0xpbmspO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbW92ZUFsbFBvcHVwcygpIHtcbiAgICAgICAgbWFwLmNsb3NlUG9wdXAoKTtcbiAgICAgICAgcG9wdXNMYXllckdyb3VwLmVhY2hMYXllcigobGF5ZXIpID0+IHtcbiAgICAgICAgICAgIHBvcHVzTGF5ZXJHcm91cC5yZW1vdmVMYXllcihsYXllcik7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldExheWVyRGVmYXVsdFN0eWxlKGxheWVyKSB7XG4gICAgICAgIGxheWVyLnNldFN0eWxlKG9iamVjdHNTZXR0aW5ncy5zdHlsZXNbbGF5ZXIuZmVhdHVyZS5wcm9wZXJ0aWVzLl9zMV0gfHwgZGVmYXVsdE9iamVjdFN0eWxlKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldExheWVySG92ZXJTdHlsZShsYXllcikge1xuICAgICAgICBsYXllci5zZXRTdHlsZShvYmplY3RzU2V0dGluZ3Muc3R5bGVzW2xheWVyLmZlYXR1cmUucHJvcGVydGllcy5fczJdKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldExheWVyQWN0aXZlU3R5bGUobGF5ZXIpIHtcbiAgICAgICAgc3dpdGNoIChsYXllci5mZWF0dXJlLmdlb21ldHJ5LnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJQb2ludFwiOlxuICAgICAgICAgICAgICAgIGxheWVyLnNldFN0eWxlKG9iamVjdHNTZXR0aW5ncy5zdHlsZXNbJ29uX2RpYWxvZ19wb2ludCddKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJNdWx0aUxpbmVTdHJpbmdcIjpcbiAgICAgICAgICAgICAgICBsYXllci5zZXRTdHlsZShvYmplY3RzU2V0dGluZ3Muc3R5bGVzWydvbl9kaWFsb2dfbGluZSddKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJQb2x5Z29uXCI6XG4gICAgICAgICAgICAgICAgbGF5ZXIuc2V0U3R5bGUob2JqZWN0c1NldHRpbmdzLnN0eWxlc1snb25fZGlhbG9nX3BvbHlnb24nXSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGFzc2V0cy9mcm9udC9qcy9tYXAtbWluaS5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFuQ0E7QUFDQTtBQXFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBQ0E7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBS0E7QUFDQTtBQWJBO0FBZUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBQ0E7QUFPQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQUNBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBckNBO0FBdUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBV0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///3\n");

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n(function () {\n\n    function questions() {\n\n        $.ajax({\n            url: '/geo/' + geoObject + '/q',\n\n            success: function success(result) {\n                var html = '';\n                var survey = result.survey;\n                var progress = result.progress;\n                var isSelectedParent = false;\n                Object.keys(survey).forEach(function (item) {\n                    var answers = survey[item].answers;\n                    var question = survey[item];\n                    var indicatorStyle = void 0;\n\n                    if (question.isAnswered && question.isCompleted) {\n                        indicatorStyle = 'text-success';\n                    } else if (question.isAnswered && !question.isCompleted) {\n                        indicatorStyle = 'text-warning';\n                    } else {\n                        indicatorStyle = 'text-black-50';\n                    }\n\n                    html += '<div class=\"mb-4 \" >\\n                            <i class=\"fas fa-check ' + indicatorStyle + '\"></i> <h5 class=\"d-inline\">' + question.title + '</h5>';\n\n                    Object.keys(answers).forEach(function (answer) {\n                        if (answers[answer].parent === null) {\n                            isSelectedParent = question.answers[answer].isSelected;\n\n                            html += '<p class=\"mb-0\"><label id=\"' + answers[answer].uuid + '\"><input class=\"answer\" type=\"' + (question.hasMultipleAnswers ? 'checkbox' : 'radio') + ('\" name=\"answers[option][' + question.uuid + '][]\"\\n                                    ') + (answers[answer].isSelected ? 'checked=\"checked\"' : '') + (' value=\"' + answers[answer].uuid + '\" /> ' + answers[answer].title + '</label></p>');\n\n                            if (question.answers[answer].isFreeAnswer) {\n                                html += '<textarea></textarea>';\n                            }\n                        } else {\n                            if (isSelectedParent === true) {\n                                html += '<div style=\"padding-left:32px;\"><label class=\"\" id=\"' + answers[answer].uuid + '\"><input class=\"answer\" type=\"checkbox\"\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tname=\"answers[option][' + question.uuid + '][]\"\\n                                    ' + (answers[answer].isSelected ? 'checked=\"checked\"' : '') + (' value=\"' + answers[answer].uuid + '\" /> ' + answers[answer].title + '</label>');\n\n                                if (answers[answer].isSelected && question.answers[answer].isFreeAnswer) {\n                                    html += '<textarea class=\"d-block\" id=\"textarea-' + question.answers[answer].uuid + ']\">' + question.answers[answer].explanation + '</textarea>';\n                                }\n\n                                html += '</div>';\n                            }\n                        }\n                    });\n\n                    if (question.isAnswered) {\n                        html += '<button type=\"button\" class=\"rem btn btn-sm btn-danger rounded-0\" name=\"answers[option][' + question.uuid + '][]\" value=\"' + question.uuid + '\"> \\u0418\\u0437\\u0447\\u0438\\u0441\\u0442\\u0438 \\u043E\\u0442\\u0433\\u043E\\u0432\\u043E\\u0440\\u0430</button>';\n                    }\n\n                    html += '</div>';\n                });\n\n                $(\"#survey\").html(html);\n\n                var article = document.querySelector('#surveyProgress');\n\n                var progressHtml = '\\n                                \\u041F\\u043E\\u043F\\u044A\\u043B\\u043D\\u0435\\u043D\\u0430 \\u0430\\u043D\\u043A\\u0435\\u0442\\u0430 ' + progress.percentage + '%<br/> \\n                                <div class=\"progress mb-4 rounded-0\">\\n                                    <div class=\"progress-bar rounded-0 pt-1 ' + (progress.percentage === 100 ? 'bg-success' : '') + ('\" role=\"progressbar\" style=\"width: ' + progress.percentage + '%;\"\\n                                         aria-valuenow=\"' + progress.percentage + '\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\\n                                </div>');\n\n                if (progress.percentage === 100) {\n                    progressHtml += '<div class=\"mt-3\">\\n                                        <a href=\"/geo/' + article.dataset.objectId + '/result\" class=\"btn btn-primary rounded-0 pt-2\">\\u0412\\u0438\\u0436 \\u0440\\u0435\\u0439\\u0442\\u0438\\u043D\\u0433\\u0430</a>\\n                                    </div>';\n                }\n\n                $(\"#surveyProgress\").html(progressHtml);\n            }\n        });\n    }\n\n    questions();\n\n    function saveExplanation(id, value) {\n\n        $.ajax({\n            type: \"POST\",\n            url: '/geo/' + geoObject + '/q',\n            data: {\n                'explanation': {\n                    \"answer\": id,\n                    \"text\": value\n                }\n            },\n            beforeSend: function beforeSend() {\n                if (document.getElementById(id)) {\n                    document.getElementById(id).style.backgroundColor = \"green\";\n                    setTimeout(function () {\n                        document.getElementById(id).style.backgroundColor = \"white\";\n                    }, 200);\n                }\n            },\n            success: function success(data) {}\n        });\n    }\n\n    var timeoutId = void 0;\n\n    $(document).on('input propertychange change', 'textarea', function () {\n        var $this = $(this);\n\n        clearTimeout(timeoutId);\n\n        timeoutId = setTimeout(function () {\n            saveExplanation($this.attr(\"id\"), $this.val());\n        }, 600);\n    });\n\n    $(document).on('click', '.answer', function () {\n        var value = this.value;\n        $.ajax({\n            type: \"POST\",\n            url: '/geo/' + geoObject + '/q',\n            data: {\n                'answer': value\n            },\n            beforeSend: function beforeSend() {\n                if (document.getElementById(value)) {\n                    document.getElementById(value).style.color = \"green\";\n                }\n            },\n            success: function success() {\n                questions();\n            }\n        });\n    });\n\n    $(document).on('click', '.rem', function () {\n        var value = this.value;\n        $.ajax({\n            type: \"POST\",\n            url: '/geo/' + geoObject + '/clear/' + value,\n\n            success: function success() {\n                questions();\n            }\n        });\n    });\n})();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9hc3NldHMvZnJvbnQvanMvc3VydmV5LmpzPzU1NTMiXSwic291cmNlc0NvbnRlbnQiOlsiKCgpID0+IHtcblxuICAgIGZ1bmN0aW9uIHF1ZXN0aW9ucygpIHtcblxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiAnL2dlby8nICsgZ2VvT2JqZWN0ICsgJy9xJyxcblxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGxldCBodG1sID0gYGA7XG4gICAgICAgICAgICAgICAgbGV0IHN1cnZleSA9IHJlc3VsdC5zdXJ2ZXk7XG4gICAgICAgICAgICAgICAgbGV0IHByb2dyZXNzID0gcmVzdWx0LnByb2dyZXNzO1xuICAgICAgICAgICAgICAgIGxldCBpc1NlbGVjdGVkUGFyZW50ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoc3VydmV5KS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBhbnN3ZXJzID0gc3VydmV5W2l0ZW1dLmFuc3dlcnM7XG4gICAgICAgICAgICAgICAgICAgIGxldCBxdWVzdGlvbiA9IHN1cnZleVtpdGVtXTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGluZGljYXRvclN0eWxlO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChxdWVzdGlvbi5pc0Fuc3dlcmVkICYmIHF1ZXN0aW9uLmlzQ29tcGxldGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3JTdHlsZSA9ICd0ZXh0LXN1Y2Nlc3MnO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHF1ZXN0aW9uLmlzQW5zd2VyZWQgJiYgIXF1ZXN0aW9uLmlzQ29tcGxldGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3JTdHlsZSA9ICd0ZXh0LXdhcm5pbmcnO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yU3R5bGUgPSAndGV4dC1ibGFjay01MCc7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBodG1sICs9IGA8ZGl2IGNsYXNzPVwibWItNCBcIiA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYXMgZmEtY2hlY2sgJHtpbmRpY2F0b3JTdHlsZX1cIj48L2k+IDxoNSBjbGFzcz1cImQtaW5saW5lXCI+JHtxdWVzdGlvbi50aXRsZX08L2g1PmA7XG5cbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoYW5zd2VycykuZm9yRWFjaChmdW5jdGlvbiAoYW5zd2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5zd2Vyc1thbnN3ZXJdLnBhcmVudCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzU2VsZWN0ZWRQYXJlbnQgPSBxdWVzdGlvbi5hbnN3ZXJzW2Fuc3dlcl0uaXNTZWxlY3RlZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gYDxwIGNsYXNzPVwibWItMFwiPjxsYWJlbCBpZD1cIiR7YW5zd2Vyc1thbnN3ZXJdLnV1aWR9XCI+PGlucHV0IGNsYXNzPVwiYW5zd2VyXCIgdHlwZT1cImAgKyAocXVlc3Rpb24uaGFzTXVsdGlwbGVBbnN3ZXJzID8gJ2NoZWNrYm94JyA6ICdyYWRpbycpICsgYFwiIG5hbWU9XCJhbnN3ZXJzW29wdGlvbl1bJHtxdWVzdGlvbi51dWlkfV1bXVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgICsgKGFuc3dlcnNbYW5zd2VyXS5pc1NlbGVjdGVkID8gJ2NoZWNrZWQ9XCJjaGVja2VkXCInIDogJycpICsgYCB2YWx1ZT1cIiR7YW5zd2Vyc1thbnN3ZXJdLnV1aWR9XCIgLz4gJHthbnN3ZXJzW2Fuc3dlcl0udGl0bGV9PC9sYWJlbD48L3A+YDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxdWVzdGlvbi5hbnN3ZXJzW2Fuc3dlcl0uaXNGcmVlQW5zd2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gYDx0ZXh0YXJlYT48L3RleHRhcmVhPmA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNTZWxlY3RlZFBhcmVudCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IGA8ZGl2IHN0eWxlPVwicGFkZGluZy1sZWZ0OjMycHg7XCI+PGxhYmVsIGNsYXNzPVwiXCIgaWQ9XCIke2Fuc3dlcnNbYW5zd2VyXS51dWlkfVwiPjxpbnB1dCBjbGFzcz1cImFuc3dlclwiIHR5cGU9XCJjaGVja2JveFwiXG5cdFx0XHRcdFx0XHRcdFx0XHRuYW1lPVwiYW5zd2Vyc1tvcHRpb25dWyR7cXVlc3Rpb24udXVpZH1dW11cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCArIChhbnN3ZXJzW2Fuc3dlcl0uaXNTZWxlY3RlZCA/ICdjaGVja2VkPVwiY2hlY2tlZFwiJyA6ICcnKSArIGAgdmFsdWU9XCIke2Fuc3dlcnNbYW5zd2VyXS51dWlkfVwiIC8+ICR7YW5zd2Vyc1thbnN3ZXJdLnRpdGxlfTwvbGFiZWw+YDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5zd2Vyc1thbnN3ZXJdLmlzU2VsZWN0ZWQgJiYgcXVlc3Rpb24uYW5zd2Vyc1thbnN3ZXJdLmlzRnJlZUFuc3dlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBgPHRleHRhcmVhIGNsYXNzPVwiZC1ibG9ja1wiIGlkPVwidGV4dGFyZWEtJHtxdWVzdGlvbi5hbnN3ZXJzW2Fuc3dlcl0udXVpZH1dXCI+JHtxdWVzdGlvbi5hbnN3ZXJzW2Fuc3dlcl0uZXhwbGFuYXRpb259PC90ZXh0YXJlYT5gO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPC9kaXY+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChxdWVzdGlvbi5pc0Fuc3dlcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IGA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cInJlbSBidG4gYnRuLXNtIGJ0bi1kYW5nZXIgcm91bmRlZC0wXCIgbmFtZT1cImFuc3dlcnNbb3B0aW9uXVske3F1ZXN0aW9uLnV1aWR9XVtdXCIgdmFsdWU9XCIke3F1ZXN0aW9uLnV1aWR9XCI+INCY0LfRh9C40YHRgtC4INC+0YLQs9C+0LLQvtGA0LA8L2J1dHRvbj5gO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBgPC9kaXY+YDtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICQoXCIjc3VydmV5XCIpLmh0bWwoaHRtbCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBhcnRpY2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3N1cnZleVByb2dyZXNzJyk7XG5cbiAgICAgICAgICAgICAgICBsZXQgcHJvZ3Jlc3NIdG1sID0gYFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDQn9C+0L/RitC70L3QtdC90LAg0LDQvdC60LXRgtCwICR7cHJvZ3Jlc3MucGVyY2VudGFnZX0lPGJyLz4gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwcm9ncmVzcyBtYi00IHJvdW5kZWQtMFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInByb2dyZXNzLWJhciByb3VuZGVkLTAgcHQtMSBgICsgKHByb2dyZXNzLnBlcmNlbnRhZ2UgPT09IDEwMCA/ICdiZy1zdWNjZXNzJyA6ICcnKSArIGBcIiByb2xlPVwicHJvZ3Jlc3NiYXJcIiBzdHlsZT1cIndpZHRoOiAke3Byb2dyZXNzLnBlcmNlbnRhZ2V9JTtcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmlhLXZhbHVlbm93PVwiJHtwcm9ncmVzcy5wZXJjZW50YWdlfVwiIGFyaWEtdmFsdWVtaW49XCIwXCIgYXJpYS12YWx1ZW1heD1cIjEwMFwiPjwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gO1xuXG4gICAgICAgICAgICAgICAgaWYgKHByb2dyZXNzLnBlcmNlbnRhZ2UgPT09IDEwMCkge1xuICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc0h0bWwgKz0gYDxkaXYgY2xhc3M9XCJtdC0zXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cIi9nZW8vJHthcnRpY2xlLmRhdGFzZXQub2JqZWN0SWR9L3Jlc3VsdFwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IHJvdW5kZWQtMCBwdC0yXCI+0JLQuNC2INGA0LXQudGC0LjQvdCz0LA8L2E+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICQoXCIjc3VydmV5UHJvZ3Jlc3NcIikuaHRtbChwcm9ncmVzc0h0bWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBxdWVzdGlvbnMoKTtcblxuICAgIGZ1bmN0aW9uIHNhdmVFeHBsYW5hdGlvbihpZCwgdmFsdWUpIHtcblxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXG4gICAgICAgICAgICB1cmw6ICcvZ2VvLycgKyBnZW9PYmplY3QgKyAnL3EnLFxuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICdleHBsYW5hdGlvbic6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhbnN3ZXJcIjogaWQsXG4gICAgICAgICAgICAgICAgICAgIFwidGV4dFwiOiB2YWx1ZSxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiZ3JlZW5cIjtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xuICAgICAgICAgICAgICAgICAgICB9LCAyMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBsZXQgdGltZW91dElkO1xuXG4gICAgJChkb2N1bWVudCkub24oJ2lucHV0IHByb3BlcnR5Y2hhbmdlIGNoYW5nZScsICd0ZXh0YXJlYScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0ICR0aGlzID0gJCh0aGlzKTtcblxuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcblxuICAgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNhdmVFeHBsYW5hdGlvbigkdGhpcy5hdHRyKFwiaWRcIiksICR0aGlzLnZhbCgpKTtcbiAgICAgICAgfSwgNjAwKTtcbiAgICB9KTtcblxuXG4gICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5hbnN3ZXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCB2YWx1ZSA9IHRoaXMudmFsdWU7XG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcbiAgICAgICAgICAgIHVybDogJy9nZW8vJyArIGdlb09iamVjdCArICcvcScsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgJ2Fuc3dlcic6IHZhbHVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJlZm9yZVNlbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHZhbHVlKS5zdHlsZS5jb2xvciA9IFwiZ3JlZW5cIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHF1ZXN0aW9ucygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcucmVtJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQgdmFsdWUgPSB0aGlzLnZhbHVlO1xuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXG4gICAgICAgICAgICB1cmw6ICcvZ2VvLycgKyBnZW9PYmplY3QgKyAnL2NsZWFyLycgKyB2YWx1ZSxcblxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHF1ZXN0aW9ucygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcblxufSkoKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gYXNzZXRzL2Zyb250L2pzL3N1cnZleS5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBMUVBO0FBNEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFEQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpCQTtBQXFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFiQTtBQWVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBRUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///4\n");

/***/ })
/******/ ]);